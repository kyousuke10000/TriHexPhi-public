
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="format-detection" content="telephone=no" />
  <title>ツクツク!!!CMS</title>
  <link rel="stylesheet" href="https://cms2.tsuku2.shop/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cms2.tsuku2.shop/css/destyle.css">
<link rel="stylesheet" href="https://cms2.tsuku2.shop/css/jquery-ui.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css" integrity="sha512-mSYUmp1HYZDFaVKK//63EcZq4iFWFjxSL+Z3T/aCt4IO9Cejm03q3NKKYN6pFQzY0SBOr8h+eCIAZHPXcpZaNw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cms2.tsuku2.shop/fonts/fontawesome/css/all.min.css?20251030171326">
<link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
<script src="https://cms2.tsuku2.shop/js/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js" integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cms2.tsuku2.shop/js/bootstrap-datepicker.ja.js"></script>
<!-- INFO: この下の行のsrcを変更する際は、/cdn-error/vue.jsも変更すること -->
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
<script>
  !!window.Vue || document.write('<script src="/js/cdn-error/vue.js"><\/script>');
</script>
<!-- INFO: この下の行のsrcを変更する際は、/cdn-error/vuex.min.jsも変更すること -->
<script src="https://unpkg.com/vuex@3.6.2/dist/vuex.min.js"></script>
<script>
  !!window.Vuex || document.write('<script src="/js/cdn-error/vuex.min.js"><\/script>');
</script>
<script src="https://cms2.tsuku2.shop/vue/store/index.js?20251030171326"></script>
<script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.8.4/Sortable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Vue.Draggable/2.23.2/vuedraggable.umd.min.js"></script>
<script src="https://cms2.tsuku2.shop/js/vue2-sfc-loader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/less"></script>
<script src="https://cms2.tsuku2.shop/js/vue-sfc-config.js?20251030171326"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv4.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script> 
<script src="https://cdn.jsdelivr.net/npm/vue-mq@1.0.1/dist/vue-mq.min.js"></script>
<!-- INFO: この下の行のsrcを変更する際は、/cdn-error/axios.min.jsも変更すること -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"></script>
<script>
  !!window.axios || document.write('<script src="/js/cdn-error/axios.min.js"><\/script>');
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/locale/ja.js"></script>
<!-- INFO: この下の行のsrcを変更する際は、/cdn-error/vuejs-paginate.jsも変更すること -->
<script src="https://unpkg.com/vuejs-paginate@2.1.0"></script>
<script>
  !!window.VuejsPaginate || document.write('<script src="/js/cdn-error/vuejs-paginate.js"><\/script>');
</script>
<script src="https://cms2.tsuku2.shop/js/bootstrap.min.js"></script>
<script src="https://cms2.tsuku2.shop/vue/modules/codeList.js?20251030171326"></script>
<script src="https://cms2.tsuku2.shop/vue/modules/common.js?20251030171326"></script>
<script src="https://cms2.tsuku2.shop/vue/modules/api.js?20251030171326"></script>
<script src="https://cms2.tsuku2.shop/vue/store/image.js?20251030171326"></script>
<script src="https://cms2.tsuku2.shop/js/main.js?20251030171326"></script>
<script>
  Vue.component('paginate', VuejsPaginate)
  Vue.config.silent = true
      Vue.config.devtools = false
  </script>
<script>
if(!window.Vue || !window.Vuex || !window.axios || !window.VuejsPaginate) {
  window.location.href = '/crowded.php';
}
</script>
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cms2.tsuku2.shop/css/base.css?20251030171326">
<link rel="stylesheet" href="https://cms2.tsuku2.shop/css/main.css?20251030171326">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
<script >bazadebezolkohpepadr="464947456"</script><script type="text/javascript" src="https://cms2.tsuku2.shop/akam/13/1bb68b76"  defer></script></head>

<body>
  <header class="header">
  <div id="header-navbar" class="header-navbar">
    <div class="hmb-menu side-menu-toggle sp-only"><span></span><span></span><span></span></div>
    <div class="logo sp-only">
      <a href="/">
        <img src="https://cms2.tsuku2.shop/images/logo.svg?20251030171326" />
      </a>
    </div>
    <ul class="nav">
      <li class="pc-only">
        <div class="toggle">
          <label>ページの掲載</label>
          <form id="form-page-toggle">
            <input type="hidden" name="mode" value="page_publish">
            <input type="hidden" name="shopToken" value="074ed07ea95dd70ee3839797e3bfa64e">
            <input type="hidden" name="publish_flg" id="publish_flg" value="0">
          </form>
          <input
            type="checkbox"
            id="toggle-page-publish"
            class="chk-page-publish"
                        disabled
            />
          <label for="toggle-page-publish" class="toggle-inner js-page-publish-label">
            <span class="publish-switch-text">未掲載</span>
          </label>  
          <script type="text/javascript">
            const publishStatus = 3 // 数値型の0,1,2,3のいずれか。2,3は掲載中にできない
            const isTempAccount = 0 === 1;
            let isPagePublish = 0 === 1;
            const isEyecatch = 1 === 1;
            const isLogo = 1 === 1;
            const isBuilder = 0 === 1;
            $(function() {
              $(document).on('click', '.js-page-publish-label', function() {
                if (isBuilder) {
                  $('.js-payment-error-message').hide();
                  $('.js-account-error-message').hide();
                  $('.js-app-error-message').hide();
                  $('.js-builder-error-message').show();
                  $('#modal-error-header-disable').modal();
                } else if (publishStatus === 3) {
                  $('.js-account-error-message').hide();
                  $('.js-builder-error-message').hide();
                  $('.js-app-error-message').hide();
                  $('.js-payment-error-message').show();
                  $('#modal-error-header-disable').modal();
                } else if (isTempAccount) {
                  $('.js-payment-error-message').hide();
                  $('.js-builder-error-message').hide();
                  $('.js-app-error-message').hide();
                  $('.js-account-error-message').show();
                  $('#modal-error-header-disable').modal();
                } else if (!isPagePublish && (!isEyecatch || !isLogo)) {
                  $('.js-mail-error-message').hide();
                  $('.js-page-error-message').show();
                  $('#modal-error-header').modal();
                } else {
                  $('#accept-change-mail').hide();
                  $('#accept-change-app').hide();
                  $('#accept-change-pagePublish').show();
                  $('.js-caution-title').html('ページの掲載の変更');
                  if (isPagePublish) {
                    $('.js-caution-text').html('ページの掲載を未掲載に変更しますか？');
                  } else {
                    $('.js-caution-text').html('ページの掲載を掲載中に変更しますか？');
                  }
                  $('#modal-caution-components-header').modal();
                }
              });
              $(document).on('click', '#accept-change-pagePublish', function() {
                const currentChecked = $('#toggle-page-publish').prop("checked");
                const publish_flg = currentChecked ? '1' : '0';
                const data = 'mode=page_publish&publish_flg=' + publish_flg
                $.ajax({
                  type: "POST",
                  url: "/Responce_header_switch.php",
                  data: data,
                  success: function(data, dataType) {
                    if (data == '1' || data == '0') { // 変更後が掲載の場合は文字列の0になる。未掲載の場合は1になる。
                      $('#publish_flg').val(data);
                      isPagePublish = data === '0'
                    } else {
                      alert(data);
                    }
                    $('.chk-page-publish').prop("checked", !currentChecked);
                    if (!currentChecked) {
                      $('.publish-switch-text').html('掲載中');
                    } else {
                      $('.publish-switch-text').html('未掲載');
                    }
                    $('#modal-caution-components-header').modal('hide');
                  },
                  // Ajax通信が失敗した場合に呼び出されるメソッド
                  error: function(XMLHttpRequest, textStatus, errorThrown) {
                    alert('Error : ' + errorThrown);
                    $("#XMLHttpRequest").html("XMLHttpRequest : " + XMLHttpRequest.status);
                    $("#textStatus").html("textStatus : " + textStatus);
                    $("#errorThrown").html("errorThrown : " + errorThrown);
                    $('#modal-caution-components-header').modal('hide');
                  }
                });
              });
            });
          </script>
        </div>
      </li>
      <li class="pc-only">
        <div class="toggle">
          <label>メルマガ会員募集</label>
          <form id="form-mailmember-toggle">
            <input type="hidden" name="mode" value="mail_member">
            <input type="hidden" name="shopToken" value="074ed07ea95dd70ee3839797e3bfa64e">
            <input type="hidden" name="mailmag_flg" id="mailmag_flg" value="0">
          </form>
          <input
            type="checkbox"
            id="toggle-mail-magazine"
            class="chk-mail-magazine"
                        disabled
          />
          <label for="toggle-mail-magazine" class="toggle-inner js-mail-publish-label">
            <span class="mailmag-switch-text">停止中</span>
          </label>
          <script type="text/javascript">
            let isMailPublished = 0 === 1;
            $(function() {
              $(document).on('click', '.js-mail-publish-label', function() {
                if (isBuilder) {
                  $('.js-payment-error-message').hide();
                  $('.js-account-error-message').hide();
                  $('.js-app-error-message').hide();
                  $('.js-builder-error-message').show();
                  $('#modal-error-header-disable').modal();
                } else if (publishStatus === 3) {
                  $('.js-builder-error-message').hide();
                  $('.js-account-error-message').hide();
                  $('.js-app-error-message').hide();
                  $('.js-payment-error-message').show();
                  $('#modal-error-header-disable').modal();
                } else if (isTempAccount) {
                  $('.js-builder-error-message').hide();
                  $('.js-payment-error-message').hide();
                  $('.js-app-error-message').hide();
                  $('.js-account-error-message').show();
                  $('#modal-error-header-disable').modal();
                } else if (!isMailPublished && !isEyecatch) {
                  $('.js-page-error-message').hide();
                  $('.js-mail-error-message').show();
                  $('#modal-error-header').modal();
                } else {
                  $('#accept-change-app').hide();
                  $('#accept-change-pagePublish').hide();
                  $('#accept-change-mail').show();
                  $('.js-caution-title').html('メルマガ会員募集の変更');
                  if (isMailPublished) {
                    $('.js-caution-text').html('メルマガ会員募集を停止中に変更しますか？');
                  } else {
                    $('.js-caution-text').html('メルマガ会員募集を募集中に変更しますか？');
                  }
                  $('#modal-caution-components-header').modal();
                }
              });
              $(document).on('click', '#accept-change-mail', function() {
                const mailCurrentChecked = $('#toggle-mail-magazine').prop("checked");
                const mail_flg = mailCurrentChecked ? '1' : '0';
                const data = 'mode=mail_member&mailmag_flg=' + mail_flg
                $.ajax({
                  type: "POST",
                  url: "/Responce_header_switch.php",
                  data: data,
                  success: function(data, dataType) {
                    if (data == '1' || data == '0') { // 変更後が停止中の場合は文字列の0になる。募集中の場合は1になる。
                      $('#mailmag').val(data);
                      isMailPublished = data === '1'
                    } else {
                      alert(data);
                    }
                    $('.chk-mail-magazine').prop("checked", !mailCurrentChecked);
                    if (!mailCurrentChecked) {
                      $('.mailmag-switch-text').html('募集中');
                    } else {
                      $('.mailmag-switch-text').html('停止中');
                    }
                    $('#modal-caution-components-header').modal('hide');
                  },
                  // Ajax通信が失敗した場合に呼び出されるメソッド
                  error: function(XMLHttpRequest, textStatus, errorThrown) {
                    alert('Error : ' + errorThrown);
                    $("#XMLHttpRequest").html("XMLHttpRequest : " + XMLHttpRequest.status);
                    $("#textStatus").html("textStatus : " + textStatus);
                    $("#errorThrown").html("errorThrown : " + errorThrown);
                    $('#modal-caution-components-header').modal('hide');
                  }
                });
              });
            });
          </script>
        </div>
      </li>
      <li class="pc-only">
        <div class="toggle">
          <label>アプリ表示</label>
          <form id="form-acquisition-toggle">
            <input type="hidden" name="mode" value="acquisition">
            <input type="hidden" name="shopToken" value="074ed07ea95dd70ee3839797e3bfa64e">
            <input type="hidden" name="acquisition_flg" id="acquisition_flg" value="0">
          </form>
          <input type="checkbox" id="toggle-customer-acquisition" class="chk-customer-acquisition"  disabled />
          <label for="toggle-customer-acquisition" class="toggle-inner js-customer-acquisition-label">
            <span class="acquisition-switch-text">非表示</span>
          </label>
          <script type="text/javascript">
            const appStatus = 0;
            let isAppPublished = 0 === 1;
            $(function() {
              $(document).on('click', '.js-customer-acquisition-label', function() {
                if (appStatus === 2) {
                  $('.js-builder-error-message').hide();
                  $('.js-payment-error-message').hide();
                  $('.js-account-error-message').hide();
                  if (isBuilder) {
                      $('.js-builder-error-message').show();
                  } else if (publishStatus === 3) {
                      $('.js-payment-error-message').show();
                  } else if (isTempAccount) {
                      $('.js-account-error-message').show();
                  }
                  $('.js-app-error-message').show();
                  $('#modal-error-header-disable').modal();
                } else if (isBuilder) {
                  $('.js-payment-error-message').hide();
                  $('.js-account-error-message').hide();
                  $('.js-app-error-message').hide();
                  $('.js-builder-error-message').show();
                  $('#modal-error-header-disable').modal();
                } else if (publishStatus === 3) {
                  $('.js-builder-error-message').hide();
                  $('.js-account-error-message').hide();
                  $('.js-app-error-message').hide();
                  $('.js-payment-error-message').show();
                  $('#modal-error-header-disable').modal();
                } else if (isTempAccount) {
                  $('.js-builder-error-message').hide();
                  $('.js-payment-error-message').hide();
                  $('.js-app-error-message').hide();
                  $('.js-account-error-message').show();
                  $('#modal-error-header-disable').modal();
                } else {
                  $('#accept-change-pagePublish').hide();
                  $('#accept-change-mail').hide();
                  $('#accept-change-app').show();
                  $('.js-caution-title').html('アプリ表示の変更');
                  if (isAppPublished) {
                    $('.js-caution-text').html('アプリ表示を非表示に変更しますか？');
                  } else {
                    $('.js-caution-text').html('アプリ表示を表示中に変更しますか？');
                  }
                  $('#modal-caution-components-header').modal();
                }
              });
              $(document).on('click', '#accept-change-app', function() {
                const appCurrentChecked = $('#toggle-customer-acquisition').prop("checked");
                const app_flg = appCurrentChecked ? '1' : '0';
                const data = 'mode=acquisition&acquisition_flg=' + app_flg
                $.ajax({
                  type: "POST",
                  url: "/Responce_header_switch.php",
                  data: data,
                  success: function(data, dataType) {
                    if (data == '1' || data == '0') { // 変更後が停止中の場合は文字列の0になる。募集中の場合は1になる。
                      $('#acquisition_flg').val(data);
                      isAppPublished = data === '1'
                    } else {
                      alert(data);
                    }
                    $('.chk-customer-acquisition').prop("checked", !appCurrentChecked);
                    if (!appCurrentChecked) {
                      $('.acquisition-switch-text').html('表示中');
                    } else {
                      $('.acquisition-switch-text').html('非表示');
                    }
                    $('#modal-caution-components-header').modal('hide');
                  },
                  // Ajax通信が失敗した場合に呼び出されるメソッド
                  error: function(XMLHttpRequest, textStatus, errorThrown) {
                    alert('Error : ' + errorThrown);
                    $("#XMLHttpRequest").html("XMLHttpRequest : " + XMLHttpRequest.status);
                    $("#textStatus").html("textStatus : " + textStatus);
                    $("#errorThrown").html("errorThrown : " + errorThrown);
                    $('#modal-caution-components-header').modal('hide');
                  }
                });
              });
            });
          </script>
        </div>
      </li>
      <li>
        <div class="notice">
          <a class="icon active" onclick='openSysShopPostModalList()'>
            <i class='bx bx-bell'></i>
            <label class="counter" id='system-shop-post-count'>*</label>
          </a>
          <a class="icon active" href="https://cms2.tsuku2.shop/com_contact_progress.php#default">
            <i class='bx bx-info-circle'></i>
            <label class="counter">0</label>
          </a>
          <a class="icon active" href="https://cms2.tsuku2.shop/m_common_ReceiveMsgList.php">
            <i class='bx bx-envelope'></i>
            <label class="counter">2</label>
          </a>
          <div class="icon active sp-only">
            <div class="user-panel user-info">
              <div id="user-icon" class="user-icon js-show-user-menu">
                                  <img src="https://cms2.tsuku2.shop/pic/store_logo/0000187505.jpg?20251102074109" />
                              </div>
              <div class="user-panel-info">
                <div class="item user-menu-header">
                  <div class="user-name"><span>CROSS OF WHITE（0000187505）</span></div>
                </div>
                <ul class="promotion">
                  <dt>今月の各種お支払い額</dt>
                  <dd>
                    <a class="content" href="https://cms2.tsuku2.shop/promocost_history.php?sales_month=2025-11">
                      <p>未確定：0円</p>
                      <p>確定：0円</p>
                    </a>
                  </dd>
                </ul>
                <ul class="shop">
                  <dt>ショップページ</dt>
                  <dd>
                                        <p><a href="https://home.tsuku2.jp/storeDetail.php?scd=0000187505" target="_blank">ホーム</a></p>
                                                            <p><a href="https://ec.tsuku2.jp/shop/0000187505" target="_blank">通販</a></p>
                                                            <p><a href="https://ticket.tsuku2.jp/events-store/0000187505" target="_blank">ウェブチケット</a></p>
                                                            <p><a href="https://gourmet.tsuku2.jp/shop/0000187505" target="_blank">グルメ</a></p>
                                                            <p><a href="https://beauty.tsuku2.jp/salon/hair/0000187505" target="_blank">ビューティー</a></p>
                                                            <p><a href="https://farm.tsuku2.jp/detail_farmer.php?scd=0000187505" target="_blank">ファーム</a></p>
                                      </dd>
                </ul>
                <ul class="status bd-none">
                  <dt>ページの掲載</dt>
                  <dd>
                    <div class="toggle">
                      <label class="publish-switch-text">未掲載</label>
                      <input
                        type="checkbox"
                        id="toggle-mb-publish"
                        class="chk-page-publish"
                                                disabled
                      />
                      <label for="toggle-mb-publish" class="toggle-inner js-page-publish-label"></label>
                    </div> 
                  </dd>
                </ul>
                <ul class="status bd-none">
                  <dt>メルマガ会員募集</dt>
                  <dd>
                    <div class="toggle">
                      <label class="mailmag-switch-text">停止中</label>
                      <input
                        type="checkbox"
                        id="toggle-mb-mailmag"
                        class="chk-mail-magazine"
                                                disabled
                      />
                      <label for="toggle-mb-mailmag" class="toggle-inner js-mail-publish-label"></label>
                    </div> 
                  </dd>
                </ul>
                <ul class="status">
                  <dt>アプリ表示</dt>
                  <dd>
                    <div class="toggle">
                      <label class="acquisition-switch-text">非表示</label>
                      <input type="checkbox" id="toggle-mb-customer-acquisition" class="chk-customer-acquisition"  disabled />
                      <label for="toggle-mb-customer-acquisition" class="toggle-inner js-customer-acquisition-label"></label>
                    </div> 
                  </dd>
                </ul>
              <div class="item agency">
                <div class="title">
                  <span>担当代理店</span>
                </div>
                <div class="content">
                  <div class="value"><a href="https://cms2.tsuku2.shop/com_person_chage.php">Ｃｒｏｓｓ　ｏｆ　ｗｈｉｔｅ　株式会社 金本　子竜</a></div>
                </div>
              </div>                
                <ul class="logout bd-none">
                  <dt>
                  <button type=“button” onclick="location.href='https://cms2.tsuku2.shop/logout.php'"><i class="fa-solid fa-arrow-right-from-bracket"></i>ログアウト</button>
                  </dt>
                </ul>  
              </div>
            </div>  
          </div> 
          <!-- ユーザー、ログアウト -->
        </div>
      </li>
      <li class="pc-only">
        <div class="user-info">
          <div id="sub-accounts">
          </div>
          <p id="sub-accounts-name" class="arrow_box">金本　子竜</p>
          <div id="user-icon" class="user-icon js-show-user-menu">
                          <img src="https://cms2.tsuku2.shop/pic/store_logo/0000187505.jpg?20251102074109" />
                      </div>  
          <div class="user-menu-wrapper">        
            <div class="user-menu">
              <div class="item user-menu-header">
                <div class="user-name"><span>CROSS OF WHITE（0000187505）</span></div>
              </div>
              <div class="item owner">
                <div class="title">
                                      <span>オーナー</span>
                                  </div>
                <div class="content">
                                    <div class="value">金本　子竜</div>
                </div>
              </div>
              <div class="item sales">
                <div class="title">
                  <span>今月の各種お支払い額</span>
                </div>
                <a class="content" href="https://cms2.tsuku2.shop/promocost_history.php?sales_month=2025-11">
                  <div class="value">
                    <span class="sales-title">未確定</span>
                    <span class="sales-value">0円</span>
                  </div>
                  <div class="value">
                    <span class="sales-title">確定</span>
                    <span class="sales-value">0円</span>
                  </div>
                </a>
              </div>
              <div class="item shop-pages">
                <div class="title">
                  <span>ショップページ</span>
                </div>
                <div class="content container-fluid">
                  <div class="row no-gutters">
                    <div class="col-md-6">
                                            <div class="value"><a href="https://home.tsuku2.jp/storeDetail.php?scd=0000187505" target="_blank">ホーム</a></div>
                                            
                                            <div class="value"><a href="https://ec.tsuku2.jp/shop/0000187505" target="_blank">通販</a></div>
                                            
                                            <div class="value"><a href="https://ticket.tsuku2.jp/events-store/0000187505" target="_blank">ウェブチケット</a></div>
                                          </div>
                    <div class="col-md-6">
                                            <div class="value"><a href="https://gourmet.tsuku2.jp/shop/0000187505" target="_blank">グルメ</a></div>
                                            
                                            <div class="value"><a href="https://beauty.tsuku2.jp/salon/hair/0000187505" target="_blank">ビューティー</a></div>
                      
                                            <div class="value"><a href="https://farm.tsuku2.jp/detail_farmer.php?scd=0000187505" target="_blank">ファーム</a></div>
                                          </div>
                  </div>
                </div>
              </div>
              <div class="item edit">
                <div class="content">
                  <div class="value"><a href="https://cms2.tsuku2.shop/basis_01.php">契約者情報の編集</a></div>
                </div>
              </div>
              <div class="item agency">
                <div class="title">
                  <span>担当代理店</span>
                </div>
                <div class="content">
                  <div class="value"><a href="https://cms2.tsuku2.shop/com_person_chage.php">Ｃｒｏｓｓ　ｏｆ　ｗｈｉｔｅ　株式会社 金本　子竜</a></div>
                </div>
              </div>
              <div class="item logout">
                <a class="logout" href="https://cms2.tsuku2.shop/logout.php"><span>ログアウト</span></a>
              </div>
            </div>
          </div>
        </div>
      </li>
    </ul>
    <script>
      let loginAccounts = [];
      $(function(){
        let currentPath = $(location).attr('pathname');
        if(currentPath.startsWith('/cms2/')) {
          currentPath = currentPath.replace('/cms2/', '');
        } else {
          currentPath = currentPath.slice(1);
        }

        const shopToken = "";  
        const params = {
          action: 'login_accounts',
          shopToken: shopToken,
          url: currentPath,
        };

        let origin = $(location).attr('origin');
        if (!origin) {
          origin = $(location).attr('protocol') + "//" + $(location).attr('hostname') + ($(location).attr('port') ? ':' + $(location).attr('port'): '');
        }
        $.post(origin + '/api/header/login_accounts.php', params, function(response) {
          loginAccounts = response.data.items;
          let htmlStr = '';
          loginAccounts.forEach(function(item, index) {
            if(index===0) {
              htmlStr += '<div class="user-icon subaccount" style="float: left;" onmouseover="showSubAccountName(`' + item.name + '`)" onmouseout="hideSubAccountName()">';
            } else {
              htmlStr += '<div class="user-icon subaccount" style="position: absolute;left: '+ 30*index + 'px"  onmouseover="showSubAccountName(`' + item.name + '`)" onmouseout="hideSubAccountName()">';
            }
            htmlStr += '<img src="https://cms2.tsuku2.shop/images/icon_subaccount.png" /></div>';
          });
          $('#sub-accounts').html(htmlStr);

          if( loginAccounts.length > 0 ) {
            $('#header-navbar').css('padding-right', 40+(30*loginAccounts.length) + 'px');
            $('#user-icon').css('position', 'absolute'); 
            $('#user-icon').css('left', 30*loginAccounts.length + 'px');
          }
        });

        $(".js-show-user-menu").on("click", (e) =>{
          $(".user-menu").stop().fadeToggle(300);
        });
        $(document).click(function(event) {
          if($(event.target).closest('#user-icon').length) return;

          if(!$(event.target).closest('.user-menu').length) {
            $(".user-menu").stop().fadeOut(300);
          } 
        });  
        $(".user-panel").on("click", (e) =>{
          $(".user-panel-info").stop().fadeToggle(300);
        });
        $(document).click(function(event) {
          if($(event.target).closest('.user-panel').length) return;

          if(!$(event.target).closest('.user-panel-info').length) {
            $(".user-panel-info").stop().fadeOut(300);
          } 
        });       
      });

      function showSubAccountName(name) {
        $('#sub-accounts-name').show();
        $('#sub-accounts-name').text(name);
      }

      function hideSubAccountName() {
        $('#sub-accounts-name').hide();
        $('#sub-accounts-name').text('');
      }
      $(".hmb-menu").click(function () {
        $(this).toggleClass('active');
    });
    </script>
  </div>
</header>
<div class="modal-wrapper">
<!-- ヘッダーのベルアイコン「システムからのショップ通知」に関連するモーダル機能関連をまとめたファイルです。 -->
<style>
    #modal-sys-shop-post-list .row{
        margin: 0;
    }
    #modal-sys-shop-post-list .row.table-header{
        background-color: #748DB8;
        text-align: center;
        color: #ffffff;
        font-size: 16px;
        padding: 10px 5px;
        text-align:left;
        border: 1px solid rgba(0,0,0,.2); 
    }
    #modal-sys-shop-post-detail .row.header span.title{
        display: inline-block;
        font-weight: bold;
        margin-bottom: 5px;
    }

    #modal-sys-shop-post-list .body a,
    #modal-sys-shop-post-detail .body a{
      color: #2875D4;
    }

    #modal-sys-shop-post-detail .body {
      background: #F5F5F5;
      padding: 10px;
    }

    #modal-sys-shop-post-list .row.table-value:first-of-type {
      border-top: 1px solid rgba(0, 0, 0, .2);
    }

    #modal-sys-shop-post-list .row.table-value{
        border: 1px solid rgba(0,0,0,.2);
        border-top: none;
        padding: 10px 15px;
        cursor: pointer;
    }
    #modal-sys-shop-post-list .row .is_read{
        display: flex;
        align-items: flex-end;
        justify-content: flex-end;
        color: #848484;
        font-size: 14px;
    }
    #modal-sys-shop-post-list .row .sub,
    #modal-sys-shop-post-detail .row .sub{
        color: #848484;
        font-size: 14px;
    }
    #modal-sys-shop-post-list .row .is_read{
        display: flex;
        align-items: flex-end;
        justify-content: flex-end;
    }
    #modal-sys-shop-post-list .button-wrapper,
    #modal-sys-shop-post-detail .button-wrapper{
        display: flex;
        justify-content: center;
        gap: 10px;
        align-items: center;
    }

    #modal-sys-shop-post-detail hr {
        border: none;
        border-top: 1px solid #848484;
        margin: 1rem 0;
    }
    #modal-sys-shop-post-list .pagination {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        gap: 6px;
        padding: 10px 0;
        flex-wrap: wrap;
        margin: 0 auto;
    }

    #modal-sys-shop-post-list .page-item {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        min-width: 36px;
        height: 36px;
        padding: 0 10px;
        font-size: 14px;
        border: 1px solid #ccc;
        border-radius: 6px;
        color: #007bff;
        background-color: #fff;
        cursor: pointer;
        user-select: none;
        transition: all 0.2s ease;
        box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        font-weight: bold;
    }

    #modal-sys-shop-post-list .page-item:hover {
        background-color: #f1f1f1;
    }

    #modal-sys-shop-post-list .page-item.current {
        background-color: #DBDBDB;
        pointer-events: none;
    }

    #modal-sys-shop-post-list .page-item.disabled {
        color: #ccc;
        border-color: #eee;
        background-color: #f9f9f9;
        cursor: default;
        pointer-events: none;
    }

    #modal-sys-shop-post-list .result-count {
        text-align: center;
        font-size: 14px;
        color: #333;
        margin-top: 4px;
    }
    #modal-sys-shop-post-list .pager {
        display: flex;
        justify-content: center;
    }

</style>
<!-- 一覧モーダル -->
<div id="modal-sys-shop-post-list" class="modal modal-alert fade">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title">通知</h1>
                <button type="button" class="button-close js-close-list-modal">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <div class="modal-body dynamic-list">
                <!-- jsで表を挿入 -->
            </div>
        </div>    
    </div>
</div>

<!-- 詳細モーダル -->
<div id="modal-sys-shop-post-detail" class="modal modal-alert fade">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title">通知詳細</h1>
                <button type="button" class="button-close js-close-detail-modal">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <div class="modal-body dynamic-detail">
                <!-- jsで表を挿入 -->
            </div>
  
            <div class="button-wrapper mb-4">
              <button type="button" class="button back-btn">一覧に戻る</button>
              <button type="button" class="button button-disable js-close-detail-modal">閉じる</button>
            </div>
     
        </div>    
    </div>
</div>
<script>
    // システムショップ通知の読み込みインターバル時間

    /**
     * 未読のシステムショップ通知のタイトルを取得し、ベルアイコンに記載の数値を更新します。
     *
     */
    function fetchUnreadTitlesAndUpdateLabel() {
        $.ajax({
            url: '/api/system_shop_post/index.php',
            type: 'POST',
            data: {
            action: 'get_unread_titles'
            },
            dataType: 'json',
            success: function(data) {
                // 未読通知の件数
                const count = data.data.length;
                $('#system-shop-post-count').text(count);
            },
            error: function(xhr, status, error) {
                console.error('通信エラー:', error);
            }
        });
    }

    /**
     * システムショップ通知の初回実行及び指定時間ごとの読み込み処理
     * 
     */
    fetchUnreadTitlesAndUpdateLabel(); // 初回即時実行
    setInterval(fetchUnreadTitlesAndUpdateLabel, 30000);

    /**
     * ベルアイコンクリックイベント
     * システムショップ通知一覧モーダルを開きます。
     * 
     */
    function openSysShopPostModalList() {
        getListDataCnt().then(function(data){            
            const current_page = 1;
            const per_page = 20;
            const total = data.cnt;
            const first_no = data.max;
            // リストの挿入
            renderNotificationList(first_no, total, current_page, per_page);
    
            // モーダルを開く
            $('#modal-sys-shop-post-list').modal();
        })
        .catch(function(error) {
            alert('件数情報取得に失敗しました。');
        });
    }

    /**
     * システムショップ通知一覧件数を取得します。
     */
    function getListDataCnt(){
        return $.ajax({
            url: '/api/system_shop_post/index.php',
            type: 'POST',
            data: {
                action: 'get_list_cnt'
            },
            dataType: 'json'
        })
        .then(response => response.data)
    }

    /**
     * システムショップ通知一覧を取得します。
     */
    function getListData(per_page, page, first_no){
        return $.ajax({
            url: '/api/system_shop_post/index.php',
            type: 'POST',
            data: {
                action: 'get_list',
                per_page: per_page,
                page: page,
                first_no: first_no
            },
            dataType: 'json'
        })
        .then(response => response.data)
    }

    /**
     * 一覧情報の表示
     */
    function renderNotificationList(first_no, total, current_page, per_page){
        // 一旦モーダル内のリストを空にする
        $('#modal-sys-shop-post-list .dynamic-list').empty();

        // データがある場合
        if (total > 0) {
            // 一覧情報取得
            getListData(per_page, current_page, first_no).then(function(listData){
                // 表タイトルの挿入
                /*
                const htmlTitle = `
                    <div class="row item table-header">
                    <div class="col-12 title">
                        <span>通知一覧</span>
                    </div>
                    </div>
                `
                $('#modal-sys-shop-post-list .dynamic-list').append(htmlTitle);
                */

                // リストの挿入
                listData.forEach(function(item) {
                    const isRead = item.read_datetime ? true : false;

                    const htmlBody = `
                        <div class="row item table-value" id="${item.no}" onclick="handlePostClick(${item.no},${current_page})">
                          <div class="w-100 mb-2"><strong>${item.title}</strong></div>
                          <div class="w-100 d-flex justify-content-between">
                            <span class="sub">${item.regist_date}</span>
                            <div class="is_read">
                              <span class="sub ${isRead ? '' : 'text-danger'}">${isRead ? '既読' : '未読'}</span>
                            </div> 
                          </div>
                        </div>
                    `;
                    $('#modal-sys-shop-post-list .dynamic-list').append(htmlBody);
                });
                const pager = `
                    <div class="row">
                        <div class="col-12">
                            <nav class="pager">
                                <ul class="pagination" id="pager-container"></ul>
                            </nav>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="result-count"><span id="result-count-container"></span></div>
                        </div>
                    </div>
                    <div class="col-12 button-wrapper">
                        <button type="button" data-dismiss="modal" class="button button-disable">閉じる</button>
                    </div>
         
                `;
                $('#modal-sys-shop-post-list .dynamic-list').append(pager);
                
                // ページャーの挿入
                renderPager({
                    total: total,
                    per_page: per_page,
                    current_page: current_page,
                    first_no: first_no,
                });
            })
            .catch(function(error) {
                alert('一覧取得に失敗しました。');
            });
        } else {
            // データがない時
            const noDataHtml = `
                <div class="col-12">
                <p>
                    通知がありません。
                </p>
                </div>
                <div class="col-12 button-wrapper">
                    <button type="button" class="button button-disable" onclick="$('#modal-sys-shop-post-list').modal('hide')">閉じる</button>
                </div>

            `;
            $('#modal-sys-shop-post-list .dynamic-list').append(noDataHtml);
        }
    }

    /**
     * ページャーと件数表示を描画する関数
     * @param {Object} options - 設定オブジェクト
     * @param {number} options.total - 総件数
     * @param {number} options.per_page - 1ページあたりの件数
     * @param {number} options.current_page - 現在のページ
     */
    function renderPager({
        total,
        per_page,
        current_page,
        first_no
    }) {
        // グローバルに定義
        sysShopPostPagerOptions = {
        total: total,
        per_page: per_page,
        first_no: first_no,
        current_page: current_page
        };

        const prevImg = '<li class="page-item" onclick="clickPager(this)" value="prev"><i class="fa-solid fa-angle-left"></i></li>';
        const nextImg = '<li class="page-item" onclick="clickPager(this)" value="next"><i class="fa-solid fa-angle-right"></i></li>';
        const linkHead = '<li class="page-item" onclick="clickPager(this)" value="';
        const linkTail = '</li>';
        const currentHead = '<li class="page-item current">';
        const linkMargin = '<li class="page-item disabled">…</li>';
        const noPrev = '<li class="page-item current"><i class="fa-solid fa-angle-left"></i></li>';
        const noNext = '<li class="page-item current"><i class="fa-solid fa-angle-right"></i></li>';
        const totalPages = Math.ceil(total / per_page);
        const pagerContainer = document.querySelector('#pager-container');
        const countContainer = document.querySelector('#result-count-container');
        
        let html = '';
        // « Prev
        if (current_page > 1) {
            html += prevImg;
        } else {
            html += noPrev;
        }

        // Page numbers
        if (totalPages <= 3) {
            for (let i = 1; i <= totalPages; i++) {
                html += (i === current_page)
                ? `${currentHead}${i}${linkTail}`
                : `${linkHead}${i}">${i}${linkTail}`;
            }
        } else {
            if (current_page <= 2) {
                for (let i = 1; i <= 3; i++) {
                html += (i === current_page)
                    ? `${currentHead}${i}${linkTail}`
                    : `${linkHead}${i}">${i}${linkTail}`;
                }
                html += `${linkMargin}`;
                html += `${linkHead}${totalPages}">${totalPages}${linkTail}`;
            } else if (current_page >= totalPages - 1) {
                html += `${linkHead}1">1${linkTail}`;
                html += `${linkMargin}`;
                for (let i = totalPages - 2; i <= totalPages; i++) {
                html += (i === current_page)
                    ? `${currentHead}${i}${linkTail}`
                    : `${linkHead}${i}">${i}${linkTail}`;
                }
            } else {
                html += `${linkHead}1">1${linkTail}`;
                html += `${linkMargin}`;
                html += `${linkHead}${current_page - 1}">${current_page - 1}${linkTail}`;
                html += `${currentHead}${current_page}${linkTail}`;
                html += `${linkHead}${current_page + 1}">${current_page + 1}${linkTail}`;
                html += `${linkMargin}`;
                html += `${linkHead}${totalPages}">${totalPages}${linkTail}`;
            }
        }
        // » Next
        if (current_page < totalPages) {
            html += nextImg;
        } else {
            html += noNext;
        }

        pagerContainer.innerHTML = html;

        // 件数表示
        const start = total === 0 ? 0 : (current_page - 1) * per_page + 1;
        const end = Math.min(total, current_page * per_page);
        countContainer.textContent = `${start}～${end}件（全${total}件中）`;
    }
    
    // ページャーのクリックイベント
    function clickPager(elem) {
        const val = elem.getAttribute('value');
        const options = sysShopPostPagerOptions;
        let page;

        if (!isNaN(parseInt(val))) {
            // 数字ならそのままページ番号として使う
            page = parseInt(val);
        } else if (val === 'prev') {
            page = Math.max(1, options.current_page - 1);
        } else if (val === 'next') {
            const total_pages = Math.ceil(options.total / options.per_page);
            page = Math.min(total_pages, options.current_page + 1);
        }
        if(page === 1){
            // 1ページ目を表示した場合は一覧を最新に更新
            getListDataCnt().then(function(data){
                const total = data.cnt;
                const first_no = data.max;
                // リストの挿入
                renderNotificationList(first_no, total, page, options.per_page);
            })
            .catch(function(error) {
                alert('件数情報取得に失敗しました。');
            });

        }else{
            renderNotificationList(options.first_no, options.total, page, options.per_page)
        }
    }

    /**
     * 一覧のタイトルクリックイベント
     * 未読の通知は既読に更新し、詳細モーダルを開きます。
     * 合わせてfetchUnreadTitlesAndUpdateLabel()を実行します。
     * 
     */

    function handlePostClick(postNo, current_page) {
        $('#modal-sys-shop-post-list').modal('hide').one('hidden.bs.modal', function () {
            openSysShopPostModalDetail(postNo, current_page);
        });
    }

    function openSysShopPostModalDetail(postNo, current_page){
        $.ajax({
            url: '/api/system_shop_post/index.php',
            type: 'POST',
            data: {
                action: 'detail',
                no: postNo
            },
            dataType: 'json'
        })
        .done(function(response) {
            // 一旦モーダル内のリストを空にする
            $('#modal-sys-shop-post-detail .dynamic-detail').empty();

            const item = response.data[0];

            const html = `
                <div class="row header">
                    <div class="col-12 title">
                        <span class='title'>${item.title}</span><br>
                        <span class='sub'>${item.regist_date} 発行</span>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-12">
                        <div class='body'>${item.body.replace(/\n/g, '<br>')}</div>
                    </div>
                </div>
            `
            $('#modal-sys-shop-post-detail .dynamic-detail').append(html);
            
            
            // モーダルを開く
            $('#modal-sys-shop-post-detail').modal();

            $('#modal-sys-shop-post-detail .back-btn').off('click').on('click', function () {
                $('#modal-sys-shop-post-detail').modal('hide').one('hidden.bs.modal', function () {
                    backToList(current_page);
                });
            }); 

            
            // 未読件数の更新
            fetchUnreadTitlesAndUpdateLabel()

            // 一覧に戻った時に既読になっているようにする
            const target = $('#modal-sys-shop-post-list #' + postNo + ' .is_read span');
            if(target.hasClass('text-danger')){

                target.removeClass(('text-danger'));
                target.text('既読');
            }
        })
        .fail(function(xhr, status, error) {
            alert('一覧取得に失敗しました。');
        });
    }

    /**
     * 一覧に戻るボタンクリックイベント
     */
    function backToList(page=null){
        // 1ページ目の場合はリストを更新
        if(page === 1){
            openSysShopPostModalList()
        }else{
            // それ以外は元のモーダル表示
            $('#modal-sys-shop-post-list').modal();
        }
    }

    $(document).on('click', '.js-close-list-modal', function () {
      $('#modal-sys-shop-post-list').modal('hide');
    });

    $(document).on('click', '.js-close-detail-modal', function () {
      $('#modal-sys-shop-post-detail').modal('hide');
    }); 

</script>  <div id="modal-error-header-disable" class="modal modal-alert fade">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title">アカウントの機能が制限されています</h1>
          <button type="button" class="button-close" data-dismiss="modal">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-12">
              <p class="js-account-error-message" style="display: none;">
                現在、仮アカウント状態です。<br>必要書類をご提出いただき、ご登録お手続きが完了いたしますと掲載に切替えることができます。
              </p>
              <p class="js-builder-error-message" style="display: none;">
                TSUKUTSUKU代理店追加契約が完了していません。
                <a class="modal-link" href="https://builders.kumu2.jp/agent_regist.php" target="_blank">BUILDER WEBサイト</a>
                にて、設定を行ってください。
              </p>
              <p class="js-payment-error-message" style="display: none;">
                現在、月額利用料の入金が確認できておらず、アカウントロック中です。ロック中はショップページ、商品ページ等が未掲載となります。ご入金確認後に掲載に切替える事ができます。
              </p>
              <p class="js-app-error-message" style="display: none;">
                ツクツク!!!アプリ契約が完了していません。
                <a class="modal-link" href="/addon/app/index.php">アプリ管理</a>
                にて、契約を行うと利用可能になります。
              </p>
            </div>
          </div>
          <div class="row">
            <div class="col-12 button-wrapper">
              <button type="button" data-dismiss="modal" class="button button-disable">閉じる</button>
            </div>
          </div>
        </div>    
      </div>
    </div>
  </div>
  <div id="modal-error-header" class="modal modal-alert fade">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title">画像が登録されていません</h1>
          <button type="button" class="button-close" data-dismiss="modal">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-12">
              <p class="js-page-error-message" style="display: none;">
                ページの掲載を掲載にするには、
                <a class="modal-link" href="/m01_01.php">ショップページ編集</a>
                でアイキャッチイメージとショップロゴの画像を登録してください。
              </p>
              <p class="js-mail-error-message" style="display: none;">
                メルマガ会員募集を募集中にするには、
                <a class="modal-link" href="/m01_01.php">ショップページ編集</a>
                でアイキャッチイメージの画像を登録してください。
              </p>
            </div>
          </div>
          <div class="row">
            <div class="col-12 button-wrapper">
              <button type="button" data-dismiss="modal" class="button button-disable">閉じる</button>
            </div>
          </div>
        </div>    
      </div>
    </div>
  </div>
  <div id="modal-caution-components-header" class="modal modal-caution-delete fade">
      <div class="modal-dialog modal-dialog-centered xl">
          <div class="modal-content">
              <div class="modal-header">
                  <h1 class="modal-title js-caution-title" style="color:#BC2021;"></h1>
                  <button type="button" class="button-close" data-dismiss="modal">
                      <i class="fa-solid fa-xmark"></i>
                  </button>
              </div>
              <div class="modal-body">
                  <div class="row">
                      <div class="col-12">
                          <p class="js-caution-text"></p>
                      </div>
                  </div>
                  <div class="row">
                      <div class="col-12 button-wrapper">
                          <button type="button" class="button button-disable mx-1" data-dismiss="modal">キャンセル</button>
                          <button type="button" id="accept-change-pagePublish" class="button button-danger mx-1">はい</button>
                          <button type="button" id="accept-change-mail" class="button button-danger mx-1">はい</button>
                          <button type="button" id="accept-change-app" class="button button-danger mx-1">はい</button>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>
</div>

<style>
.arrow_box {
  display: none;
  position: absolute;
  width: 140px;
  padding: 8px;
  top: 50px;
  left: -60px;
  background: #fff;
  color: #000;
  border: 1px solid;
  /*
  -webkit-border-radius: 8px;
  -moz-border-radius: 8px;
  border-radius: 8px;
  background: #333;
  color: #fff;
  */
  text-align: center;
  font-size: 14px;
}

.arrow_box:after {
  position: absolute;
  bottom: 100%;
  left: 50%;
  width: 0;
  height: 100px;
  margin-left: -10px;
  /*
  border: 1px solid;
  */
  border-color: rgba(51, 51, 51, 0);
  /*
  border-bottom-color: #333;
  */
  border-width: 10px;
  /*
  pointer-events: none;
  */
  content: ' ';
}
/*
.subaccount:hover + p.arrow_box {
  display: block;
}
*/

.modal-caution-delete#modal-caution-components-header .modal-dialog .modal-content .modal-body .button-wrapper {
  margin-top: 0;
}
.modal-caution-delete#modal-caution-components-header .modal-dialog .modal-content .modal-body p {
  font-size: 16px;
}
.modal-alert#modal-error-header .modal-dialog .modal-content .modal-header,
.modal-alert#modal-error-header-disable .modal-dialog .modal-content .modal-header,
.modal-alert#modal-error-change-staff-reserve .modal-dialog .modal-content .modal-header,
.modal-caution-delete#modal-caution-components-header .modal-dialog .modal-content .modal-header {
    color: #BC2021;
    background: rgba(188, 32, 33, 0.2);
}
.modal-link {
  color: #2875D4;
  text-decoration: underline;
}
</style>  


<div id="sidebar" class="pc-only" :class="{closed: option.isClosed}" :key="key">
  <div class="wrapper">
    <a class="logo pc-only" href="https://cms2.tsuku2.shop">
      <img src="https://cms2.tsuku2.shop/images/logo.svg?20251030171326" />
    </a>
    <a class="logo-small pc-only" href="/">
      <img src="https://cms2.tsuku2.shop/images/logo_small.svg?20251030171326" />
    </a>
    <div class="user-info sp-only">
      <div class="user-menu">
        <div class="item user-menu-header">
          <div class="user-icon image-wrapper">
                      <img src="https://cms2.tsuku2.shop/pic/store_logo/0000187505.jpg?20251102074109" />
                      </div>
          <div class="user-name">
            <span>CROSS OF WHITE</span>
            <span>（0000187505）</span>
          </div>
        </div>
        <div class="item owner">
          <div class="title">
            <span>オーナー</span>
          </div>
          <div class="content">
            <div class="value">金本子竜</div>
          </div>
        </div>
      </div>
    </div>
    <div style="opacity:0;" class="navbar" v-if="!loading">
      <ul>
        <li class="nav-item" v-if="false">
          <div class="nav-header">
            <div class="icon">
              <i class='bx bx-building-house' ></i>
            </div>
            <div class="label">
              <span><a href="https://cms2.tsuku2.shop/dashboard.php">ダッシュボード</a></span>  
            </div>  
          </div>
        </li>
        <li class="nav-item"
          v-for="menu in menus" :key="menu.name"
          v-if="checkViewMenu(menu)"
          :class="[
            {active: isMenuActive(menu, option.currentModule)},
            {current: menu.name === option.currentModule},
          ]"
          @click="menuClick(menu)"
        >
          <template v-if="addonCheck(menu.addon_no)">
            <template v-if="menu.path && menu.path.length > 0">
              <template v-if="menu.name.indexOf('オンラインマニュアル') > -1 || menu.no == 281 || menu.no == 283">
                <a :href="menu.path" target="_blank" class="nav-header">
                  <div class="icon">
                    <i :class="iconClass(menu.name)"></i>
                  </div>
                  <div class="label">
                    <span>{{menu.name}}</span>
                    <!-- 基本設定で未完了の項目がある場合にアイコンを表示する -->
                    <span
                      v-if="menu.name === '基本設定' && noCountBasicSetting > 0"
                      class="notice-counter">
                      {{ noCountBasicSetting }}
                    </span>
                  </div>
                </a>
              </template>
              <template v-else>
                <a :href="menu.path" class="nav-header">
                  <div class="icon">
                    <i :class="iconClass(menu.name)"></i>
                  </div>
                  <div class="label">
                    <span>{{menu.name}}</span>
                    <!-- 基本設定で未完了の項目がある場合にアイコンを表示する -->
                    <span
                      v-if="menu.name === '基本設定' && noCountBasicSetting > 0"
                      class="notice-counter">
                      {{ noCountBasicSetting }}
                    </span>
                  </div>
                </a>
              </template>
            </template>
            <template v-else>
              <div class="nav-header">
                <div class="icon">
                  <i :class="iconClass(menu.name)"></i>
                </div>
                <div class="label">
                  <span>{{menu.name}}</span>
                </div>
              </div>
            </template>
          </template>
          <div class="nav-body" v-if="menu.heading && menu.heading.length > 0">
            <div class="inner">
              <template v-for="headingItem in menu.heading" :key="headingItem.name">
                <div v-if="addonCheck(headingItem.addon_no)" class="menu" :class="[
                  {'have-body': headingItem.sub && headingItem.sub.length > 0},
                  {active: isMenuActive(headingItem, option.currentMenuHeading)}
                ]">
                    <div class="menu-header" @click.stop="menuClick(headingItem)">
                        <div v-if="isTargetBlankLink(headingItem.no)">
                            <h3><a :href="headingItem.path" target="_blank">{{headingItem.name}}</a></h3>
                        </div>
                        <div v-else-if="headingItem.path && headingItem.path.length > 0">
	                        <h3><a :href="headingItem.path">{{headingItem.name}}</a></h3>
                        </div>
                        <div v-else-if="existActiveSub( headingItem.sub )">
                          <h3>{{headingItem.name}}</h3>
                        </div>
                    </div>
                    <div class="menu-body"
                      v-if="headingItem.sub && headingItem.sub.length > 0"
                    >
                      <ul>
                        <li class="menu-sub" @click.stop="menuClick(subsub,true)"
                          v-for="subsub in headingItem.sub" :key="subsub.name"
                          :class="{active: isMenuActive(subsub, option.currentMenu)}"
                        >
                          <template v-if="addonCheck(subsub.addon_no)">
                            <a :href="subsub.path">{{subsub.name}}</a>
                          </template>
                        </li>
                      </ul>
                    </div>
                </div>
              </template>
            </div>
          </div>       
        </li>
        <li class="nav-item toggle-nav" @click="closeSidebar()">
          <div class="nav-header">
            <div class="icon border-bottom-solid">
              <i class='bx bx-chevrons-left' ></i>
            </div>
            <div class="label no-arrow border-bottom-solid">
                <span id="closeSidebarText">{{option.isClosed ? '開く' : '閉じる'}}</span>
            </div>
          </div>
        </li>
      </ul>
    </div>  
  </div>
</div>
<div id="modal-error-sidebar" class="modal modal-alert fade">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title">エラーが発生しました。</h1>
        <button type="button" class="button-close" data-dismiss="modal">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-12">
            <p id="modal-error-sidebar-msg"></p>
            <ul id="modal-error-sidebar-msg-list" class="error-msg-list"></ul>
          </div>
        </div>
        <div class="row">
          <div class="col-12 button-wrapper">
            <button type="button" data-dismiss="modal" class="button button-disable">閉じる</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <script src="https://cms2.tsuku2.shop/components/sitemap.js"></script>
  <script src="https://cms2.tsuku2.shop/vue/store/basicSetting.js?20251030171326"></script>
  <script>
   const menu_auth_data =null;

(async () => {
  store.registerModule("basic", basicSetting);
  const sidebarVue = new Vue({
    el: '#sidebar',
    store,
    data(){
      return{
        loading: false,
        option:{
            isClosed: false,
        },
        text: {
            haveBody: "have-body",
        },
        menus: [],
        menu_auth_data: [],
        agreement_addon: [],
        key: 0,
      }
    },
    computed: {
      noCountBasicSetting() {
        const count = this.$store.state.basic.baseSetting.no_count;
        return !!count ? count : 0;
      }
    },
    async mounted() {
      this.loading = true
      this.loading = false
      this.menu_auth_data.push("common");

      this.setShopTokenAction("")
      const api = new API();
      const paramsBasicSetting = {
        action: "get_base_setting",
        shopToken: "20dbab11b42fb4ef895f43216b0c6b32",
      };
      const responseBasicSetting = await api.axiosAction("common_setting", paramsBasicSetting);
      if (responseBasicSetting.error_flag !== 0) {
        this.showModalError(responseBasicSetting.message);
        return;
      }
      const baseSettingData = responseBasicSetting.data[0]
      this.$store.dispatch('setBaseSettingAction', baseSettingData)

      const params = {
        shopToken: this.$store.state.shopToken,
        action: "get_sitemap",
      };
      const response = await api.axiosAction("sitemap", params);
      this.menus = response.data.sitemap;
      this.agreement_addon = response.data.addon;

      let currentFile = $(location).attr('pathname');
      if(currentFile.startsWith('/cms2/')) {
        currentFile = currentFile.replace('/cms2/', '');
      } else {
        currentFile = currentFile.slice(1);
      }
      let activeSet = true;

      // 特定のオリジナルパスを判定
      let url = "https://cms2.tsuku2.shop";
      if(url.indexOf('localhost') !== -1 ) url = `${url}`;

      this.menus = this.menus.map( (menu) => {
        let _menu = {...menu, isAcvive: false, checkId : "" };
        if(menu.path && menu.path.indexOf("http") === -1) _menu.path = `${url}/${menu.path}`;

        _menu.heading = !!_menu.heading && _menu.heading.map( (subsItems) => {
          let _subsItems = {...subsItems, isAcvive: false};
          if(subsItems.path && subsItems.path.indexOf("http") === -1) _subsItems.path = `${url}/${subsItems.path}`;
          if( subsItems.path !== "" && !subsItems.sub && subsItems.path === currentFile && activeSet){
            _menu.isAcvive = true;
            _subsItems.isAcvive = true;
            activeSet = false;
            return _subsItems;
          } else if (subsItems.path !== "" && !subsItems.sub ) {
            return _subsItems;
          } else {
            _subsItems.sub =_subsItems.sub.map( (item) => {
              let _item = {...item, isAcvive: false };

              if (item.path.indexOf("http") === -1 ) {
                _item.path = `${url}/${item.path}`;
              } else {
                _item.path = `${item.path}`;
              }

              if ( _item.path !== "" &&  item.path === currentFile && activeSet ) {
                _menu.isAcvive = true;
                _subsItems.isAcvive = true;
                _item.isAcvive = true;
                activeSet = false;
              }

              if( item.children && item.children.length > 0 && activeSet ) {
                _item.children.forEach( ci => {
                  // "m_common_item_html.php"の時には、前のページdocument.referrerによってアクティブにする項目を変える
                  if (ci.path === currentFile && (
                    ci.path !== "m_common_item_html.php" ||
                    document.referrer.includes('m03') && item.no === 68
                  )) {
                    _menu.isAcvive = true;
                    _subsItems.isAcvive = true;
                    _item.isAcvive = true;
                    activeSet = false;
                  }
                });
              }
              return _item;
            });
            return _subsItems;
          }
        });
        return _menu;
      });
      this.menus = this.menus.filter((menu) => (menu.name !== "カテゴリ不明/その他" && menu.name !== "ログイン"))

      $("#sidebar .navbar").addClass('visible');
      const currentPath = window.location.pathname;
    },
    methods:{
      ...Vuex.mapActions(["setShopTokenAction", "setErrorAction"]),
      checkViewMenu(menu){
        if(menu.mane === "アドオン" ||
           menu.mane === "コンタクト・お知らせ" ||
           menu.mane === "カウント"
         ) {
          menu_auth_data.includes(menu.checkId)
        } else {
          return true;
        }
      },
      existActiveSub( sub ) {
        const activeSub = sub.filter( ( subsub ) => {
          return this.addonCheck( subsub.addon_no );
        });
        if ( activeSub.length > 0 ) {
          return true;
        }
        return false;
      },
      addonCheck( addon_no ) {
        if ( addon_no == "" || addon_no == null ) {
          return true;
        }
        if ( this.agreement_addon.includes( addon_no ) ) {
          return true;
        }
        return false;
      },
      closeSidebar(){
        if (data.isPC) {

          if ($('#closeSidebarText').text() === '閉じる' && this.option.isClosed) {
           this.option.isClosed = false;
           this.key = this.key ? 0 : 1;
          }
          this.option.isClosed = !this.option.isClosed
        } else {
          $("#sidebar").removeClass('active').scrollLock.remove()
        }
      },
      menuClick(menu,flag_a){
        if(!flag_a) {
          menu.isAcvive = !menu.isAcvive
        }
      },
      isMenuActive(menu, current){
        if(menu.isAcvive){
            return true
        }else{
            return false
        }
      },

      iconClass(name){
        switch (name) {
          case "ダッシュボード":
            return 'bx bx-building-house'
          case "ホーム機能":
            return "bx bx-store-alt";
          case "基本設定":
            return "fa-solid fa-gear";
          case "集客":
            return "bx bx-user-voice";
          case "通販・DS":
            return "bx bx-shopping-bag";
          case "ファーム":
            return "fa-solid fa-wheat-awn";
          case "D.S.":
            return "bx bx-package";
          case "ウェブチケット":
            return "fa-solid fa-ticket";
          case "グルメ":
            return "bx bx-bowl-rice";
          // case "ビューティー":
          case "ビューティー β版":
            return "bx bx-spa";
          case "アプリ":
            return "bx bx-mobile";
          case "アドオン":
            return "bx bx-message-alt-add";
          case "コンタクト・お知らせ":
            return "fa-solid fa-bullhorn";
          case "アカウント":
            return "bx bx-user";
          case "販促品":
            return "bx bx-basket"
          case "オンラインマニュアル":
            return "bx bx-book-open"
          case "サポート":
            return "fa-solid fa-hand-holding-heart"
          case "規約・ガイドライン":
            return "fa-solid fa-shield-halved"
          case "ノムノム":
            return "fa-solid fa-martini-glass-citrus"
          case "イベチケ":
            return "fa-solid fa-microphone"
          case "ツクツク!!!ASPメール":
            return "fa-solid fa-envelope"
          default:
            break;
        }
      },
      showModalError(messages) {
        if (!Array.isArray(messages) || !messages.length) return;
        if (messages.length === 1) {
          const pElement = document.getElementById("modal-error-sidebar-msg");
          pElement.textContent = messages[0];
        } else {
          const ulElement = document.getElementById("modal-error-sidebar-msg-list");
          messages.forEach(msg => {
            const liElement = document.createElement("li");
            liElement.textContent = msg;
            ulElement.appendChild(liElement);
          });
        }
        $('#modal-error-sidebar').modal('show');
      },
      isTargetBlankLink(no) {
        const targetBlankLinks = [
          182,  // ツクツク!!!CMSご利用規約
          278,  // 出店可能風俗営業等業種一覧表
          287,  // ノムノム出店ガイドライン
          288,  // ノムノム出店規約
          290,  // イベチケ出店規約
        ];
        return targetBlankLinks.includes(no);
      },
    }
  });
})()
  </script>
<style type="text/css">
.nav-item a{
  color: #fff;
}

.nav-item a:hover{
  color: #fff;
}

.navbar.visible {
  opacity: 1 !important;
  transition: opacity 0.2s;
}
.nav-item .notice-counter {
  background-color: #BC2021;
  margin-left: 5px;
  border-radius: 10px;
  width: 20px;
  text-align: center;
  font-size: 12px;
}
#modal-error-sidebar.modal.modal-alert {
  z-index: 2000;
}
#modal-error-sidebar.modal.modal-alert .modal-dialog .modal-content .modal-header {
  color: #BC2021;
  background: rgba(188, 32, 33, 0.2);
}
#modal-error-sidebar.modal.modal-alert .modal-dialog .modal-content .modal-body .error-msg-list {
  padding: 0 20px;
  list-style: disc;
}
#modal-error-sidebar.modal.modal-alert .modal-dialog .modal-content .modal-body .error-msg-list .error-msg {
  line-height: 30px;
}
#modal-error-sidebar.modal.modal-alert .modal-dialog .modal-content .modal-body .button-wrapper .button-disable {
  color: #FFFFFF;
}
</style>  <main class="dashboard">
    <div class="container">
      <div class="inner">
        <div id="informations">
          <transition name="fade">
            <div v-if="!loading">
              <!--<div class="emg-notice" @click="showModalInfo(emgNoticeItem)">-->
              <section class="notice-list">
                <notice-builder v-if="builderFlg === 1"></notice-builder>
                <!-- 参考のためコメントとして残しておくこと -->
                <!-- <div class="banners">
                  <notice-global-tag v-for="(item, index) in globalTagNotices" :key="item.page_id" :info="item" :index="index" @detail="showGlobalTagModal" v-if="item.show_page">
                  </notice-global-tag>
                </div>
                <div class="banners cardboard_campaign">
                  <a href="./order_cart/detail.php?item_cd=0000000001#cardboard_campaign">
                    <img src="./images/dashboard/banner_cardboard_campaign_PC.png" alt="ショップオリジナルダンボール制作期間限定冬のお得なクーポンキャンペーン" width="100%" class="greater-than-md-width"/>
                    <img src="./images/dashboard/banner_cardboard_campaign_SP.png" alt="ショップオリジナルダンボール制作期間限定冬のお得なクーポンキャンペーン" width="100%" class="md-width" />
                  </a>
                </div> -->

                <!-- <section class="nobori-campaign">
                  <a href="./order_cart/detail.php?item_cd=0000000002">
                    <img src="/images/order_cart/campaign/tsuku2_raksul_campaign_banner.png" alt="のぼりキャンペーン" />
                  </a>
                </section> -->

                <notice-account-lock class="mb-3" v-if="accountLock" @detail="showAccountLockModal"></notice-account-lock>
                <notice-unpaid class="mb-3" :unpaid="unpaidLock" v-if="unpaidLock.lock"></notice-unpaid>
                <notice-credit class="mb-3" :count="imminentLoanExpirationCount" @detail="showCreditModal" v-if="imminentLoanExpirationCount > 0">
                </notice-credit>
                <notice class="mb-3" v-for="(item, index) in getNoticeList" :key="item.subject" :info="item" :isDanger="index === 2"
                  @detail="showModalInfo(item)"></notice>
                <google-notice class="mb-3" v-if="google_info.length !== 0" :message="google_info.info" :mcc_updated_at="google_info.mcc_updated_at" @detail="showModalAlertGoogleSetting">
                </google-notice>
                <notice-container class="mb-3"></notice-container>
              </section>
              <section class="news">
                <div class="row card-wrapper" :class="{'no_notices': (notice_numbers === 0 && this.$mq === 'md')}">
                  <div class="col-lg-8 notice_block" v-if="notice_numbers > 0">
                    <card-news v-if="info_list.length > 0" :news-list="info_list" :options="options.devNoticeListOption" @detail="showModalInfo"></card-news>
                    <card-news v-if="fault_information.length > 0" :news-list="fault_information" :options="options.systemErrorListOption" @detail="showModalInfo"></card-news>
                    <card-news v-if="maintenance.length > 0" :news-list="maintenance" :options="options.mentenanceListOption" @detail="showModalInfo"></card-news> 
                  </div>
                  <div class="col-lg-4 fee_block" :class="{'fee_cards': notice_numbers === 0}">
                    <card-use-fee :card-use-fee="useFee"></card-use-fee>
                    <card-sales-fee :card-sales-fee="SalesFee"></card-sales-fee>
                  </div>
                </div>
              </section>
              <div class="modal-wrapper">
              <modal-info :modal-info-data="modalInfoData">
                <template v-slot:notice_created_at>
                  {{getDateTime(modalInfoData.notice_created_at)}}
                </template>
                <template v-slot:notice_updated_at>
                  {{getDateTime(modalInfoData.notice_updated_at)}}
                </template>
                <template v-slot:category>
                  {{modalInfoData.category}}
                </template>
                <template v-slot:title>
                  {{modalInfoData.subject}}
                </template>
                <template v-slot:content>
                  <div v-html="modalInfoData.body"></div>
                </template>
              </modal-info>
              </div>
              <div class="modal-wrapper">
                <modal-alert-basic-setting><modal-alert-basic-setting />
              </div>
              <div class="modal-wrapper">
                <modal-alert-google-setting v-if="google_info.length !== 0" :contents="google_info.contents"><modal-alert-google-setting />
              </div>
              <div class="modal-wrapper">
                <modal-alert-notice-list :notice_list="alert_notice_list" @on-read-notice="onReadNotice" :is_show_modal="isShowAlertNoticeList"><modal-alert-notice-list />
              </div>
              <div class="modal-wrapper">
                <modal-credit-info ref="modalCreditInfo" :info="imminentLoanExpiration"><modal-credit-info />
              </div>
            </div>
          </transition>
        </div>
        <div id="app" v-cloak>
          <transition name="fade">
            <div v-if="!loading">
              <section class="row info-row">
                <div class="col-lg-6">
                  <card-message :message-list="message"></card-message>
                </div>
                <div class="col-lg-6">
                  <card-update-info :items="update_info"></card-update-info>
                </div>
              </section>
              <section class="summary">
                <div class="row">
                  <div class="col-12 col-lg-8 col-md-12">
                    <card-summary-page-access :page_access_summary="summaryList.page_access_summary" :agreement-info="areementInfo">
                    </card-summary-page-access>
                  </div>
                  <div class="col-12 col-lg-4 col-md-6 col-sm-6 tsuku2-app">
                    <card-summary-app :summary="summaryListApp" :agreement="areementInfo.app">
                      <template v-slot:icon>
                        <div class="card-header-icon" :style="summaryListColor.appColor">
                          <i :class="summaryListIcon.appIcon"></i>
                        </div>
                      </template>
                    </card-summary-app>
                  </div>
                  <!-- module判定 -->
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 item_order" v-if="areementInfo.shop === 1||areementInfo.ds === 1">
                    <card-summary-shop :summary="summaryList.item_order_summary" :agreement="areementInfo">
                      <template v-slot:icon>
                        <div class="card-header-icon"
                          :style="summaryListColor.itemOrderColor">
                          <i :class="summaryListIcon.itemOrderIcon"></i>
                        </div>
                      </template>
                    </card-summary-shop>
                  </div>

                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 webticket" v-if="areementInfo.webticket === 1">
                    <card-summary-shop :summary="summaryList.ticket_summary" :agreement="areementInfo.webticket">
                      <template v-slot:icon>
                        <div class="card-header-icon"
                          :style="summaryListColor.ticketColor">
                          <i :class="summaryListIcon.ticketIcon"></i>
                        </div>
                      </template>
                    </card-summary-shop>
                  </div>

                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 event" v-if="areementInfo.event === 1">
                    <card-summary-shop :summary="summaryList.event_summary" :agreement="areementInfo.event">
                      <template v-slot:icon>
                        <div class="card-header-icon"
                          :style="summaryListColor.eventColor">
                          <i :class="summaryListIcon.eventIcon"></i>
                        </div>
                      </template>
                    </card-summary-shop>
                  </div>

                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 gurumet" v-if="areementInfo.gurumet === 1">
                    <card-summary-shop :summary="summaryList.gurumet_summary" :agreement="areementInfo.gurumet">
                      <template v-slot:icon>
                        <div class="card-header-icon"
                          :style="summaryListColor.gurumetColor">
                          <i :class="summaryListIcon.gurumetIcon"></i>
                        </div>
                      </template>
                    </card-summary-shop>
                  </div>

                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 beauty" v-if="areementInfo.beauty === 1">
                    <card-summary-shop :summary="summaryList.beauty_summary" :agreement="areementInfo.beauty">
                      <template v-slot:icon>
                        <div class="card-header-icon"
                          :style="summaryListColor.beautyColor">
                          <i :class="summaryListIcon.beautyIcon"></i>
                        </div>
                      </template>
                    </card-summary-shop>
                  </div>

                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 farm" v-if="areementInfo.farm === 1">
                    <card-summary-shop :summary="summaryList.farm_summary" :agreement="areementInfo.farm">
                      <template v-slot:icon>
                        <div class="card-header-icon"
                          :style="summaryListColor.farmColor">
                          <i :class="summaryListIcon.farmIcon"></i>
                        </div>
                      </template>
                    </card-summary-shop>
                  </div>
                </div>
                <div class="row">
                  <div v-for="summary in getOtherSummaryList" :key="summary.name" :class="'col-6 col-md-3 col-sm-6'">
                    <card-summary-other :summary="summary"
                      v-if="summary.id !== 'gourmand' && summary.id !== 'beauty' && summary.id !== 'app-contents'">
                    </card-summary-other>
                  </div>
                </div>
              </section>
              <section class="customer-review">
                <div class="row">
                  <div class="col-12">
                    <card-customer-review :customer-review="customer_review"></card-customer-review>
                  </div>
                </div>
              </section>
              <section class="special-entry" style="display: none;">
                <div class="row">
                  <div class="col-12">
                    <card-special-entry :special-entry-list="ibent"></card-special-entry>
                  </div>
                </div>
              </section>
              <section class="oparation-log">
                <operation-log
                  :shop-id="$store.state.shopId"
                  :shop-token="$store.state.shopToken"
                ></operation-log>
              </section>
              <modal-success ref="modalSuccess" :info="successInfo"></modal-success>
              <modal-error></modal-error>
              <modal-promo @success="successAction" @error="errorAction"></modal-promo>
              <!-- 参考のためコメントとして残しておくこと -->
              <!-- <modal-global-tag :info="modalGlobalTagInfo"></modal-global-tag> -->
            </div>
          </transition>
        </div>
        <div id="spinner">
          <div class="spinner-content">
          </div>
        </div>
      </div>
    </div>
  </main>
  <footer>
  <div class="container">
    <div class="inner">
      <div class="scroll-top">
        <a class="js-scroll-top"><i class="fa-solid fa-circle-arrow-up"></i><span>上に戻る</span></a>
        <script>
          $(".js-scroll-top").click(function () {
            $('body,html').animate({
                scrollTop: 0
            }, 300)
            return false;
          })
        </script>
      </div> 
      <div class="row">
        <ul class="sitemap">
          <li><a href="https://cms2.tsuku2.shop/com_doc_agree.php">ご利用規約</a></li>
          <li><a href="https://cms2.tsuku2.shop/com_doc_privacy.php">個人情報保護方針</a></li>
          <li><a href="https://cms2.tsuku2.shop/com_doc_prohibit.php">取り扱い禁止商品</a></li>
          <li><a href="https://manual.tsuku2.store" target="_blank">オンラインマニュアル</a></li>
          <li><a href="https://cms2.tsuku2.shop/com_contact_new.php#default">サポートデスク</a></li>
        </ul>
      </div>
      <div class="copyright">
        <p>Copyright ©2025 TSUKU TSUKU Inc. all rights reserved.</p>
      </div>
    </div>
  </div>
</footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"
    integrity="sha512-a+mx2C3JS6qqBZMZhSI5LpWv8/4UK21XihyLKaFoSbiKQs/3yRdtqCwGuWZGwHKc5amlNN8Y7JlqnWQ6N/MYgA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
  <script src="https://unpkg.com/vue-chartjs@3.5.1/dist/vue-chartjs.min.js"></script>
  <script>
    const VueMq = window['vueMq'];
  (async () => {
    const api = new API()
    const dashboardPath = "./vue/pages/dashboard/"
    const modalPath = "./vue/components/modal/"
    //info_components
    const info_components = [
      loadVue(dashboardPath + 'NoticeCredit.vue'),
      loadVue(dashboardPath + 'NoticeUnpaid.vue'),
      loadVue(dashboardPath + 'NoticeAccountLock.vue'),
      loadVue(dashboardPath + 'NoticeBuilder.vue'),
      loadVue(dashboardPath + 'GoogleNotice.vue'),
      loadVue(dashboardPath + 'NoticeWithdraw.vue'),
      loadVue(dashboardPath + 'NoticeContainer.vue'),
      loadVue(dashboardPath + 'CardUseFee.vue'),
      loadVue(dashboardPath + 'CardSalesFee.vue'),
      loadVue(dashboardPath + 'CardNews.vue'),
      loadVue(dashboardPath + 'ModalInfo.vue'),
      loadVue(dashboardPath + 'ModalCreditInfo.vue'),
      loadVue(dashboardPath + 'ModalAlertBasicSetting.vue'),
      loadVue(dashboardPath + 'ModalAlertGoogleSetting.vue'),
      loadVue(dashboardPath + 'ModalAlertNoticeList.vue'),
      loadVue(modalPath + 'ModalSuccess.vue'),
      loadVue(modalPath + 'ModalError.vue'),
    ]
    const [
      NoticeCredit,
      NoticeUnpaid,
      NoticeAccountLock,
      NoticeBuilder,
      GoogleNotice,
      NoticeWithdraw,
      NoticeContainer,
      CardUseFee,
      CardSalesFee,
      CardNews,
      ModalInfo,
      ModalCreditInfo,
      ModalAlertBasicSetting,
      ModalAlertGoogleSetting,
      ModalAlertNoticeList,
      ModalSuccess,
      ModalError,
     ] = await Promise.all(info_components);

    Vue.use(VueMq, {
      breakpoints: {
        sm: 1024,
        md: Infinity,
      },
      defaultBreakpoint: 'sm'
    })

    const informations = new Vue({
      el: '#informations',
      vuetify: new Vuetify(),
      store,
      components: {
        NoticeCredit,
        NoticeUnpaid,
        NoticeAccountLock,
        NoticeBuilder,
        GoogleNotice,
        NoticeWithdraw,
        NoticeContainer,
        CardUseFee,
        CardSalesFee,
        CardNews,
        ModalInfo,
        ModalCreditInfo,
        ModalAlertBasicSetting,
        ModalAlertGoogleSetting,
        ModalAlertNoticeList,
        ModalSuccess,
        ModalError,
      },
      data() {
        return {
          loading: true,
          currentDate: "",
          notice_info: {"info_list":[],"fault_information":[],"maintenance":[],"usage_fee":{"date":"2025\u5e7410\u6708","total":null,"module":null,"app_add_on":null,"add_on":null},"sales_amount":{"date":"2025\u5e7410\u6708","amount":null},"item_credit":[],"webticket_credit":[],"gurumet_credit":[],"beauty_credit":[],"app_credit":[],"google_error_msg":"","account_lock":true,"unpaid_lock_date":""},
          SalesFee: {},
          useFee: {},
          // Google障害
          google_info: [],
          //運営より
          info_list: [],
          //メンテナンス
          maintenance: [],
          //障害情報
          fault_information: [],
          imminentLoanExpirationCount: 0,
          imminentLoanExpiration: {
            items: [],
            webtickets: [],
            gurumets: [],
            beauties: [],
            apps: [],
          },
          unpaidLock: {
            lock: false,
            lock_date: '',
            list: [],
          },
          accountLock: false,
          withdraw: 0,
          options: {
            devNoticeListOption: {
              icon: '<img src="./images/tsukutsuku_sitelogo_white_mark.png" />',
              color: "#2875d4",
              title: "運営より",
              url: "/com_noti.php?c=1&searchNoti=&cmd=1",
            },
            mentenanceListOption: {
              icon: '<i class="fa-solid fa-wrench"></i>',
              color: "#848484",
              title: "メンテナンス",
              url: "/com_noti.php?c=2&searchNoti=&cmd=1",
            },
            systemErrorListOption: {
              icon: '<i class="fa-solid fa-bell"></i>',
              color: "#E89F96",
              title: "障害情報",
              url: "/com_noti.php?c=3&searchNoti=&cmd=1",
            },
          },
          modalInfoData: {
            notice_created_at: "",
            notice_updated_at: "",
            category: "",
            subject: "",
            body: "",
            level: 0,
            is_show_modal: false,
          },
          builderFlg: 0,
          alert_notice_list: [],
          notice_numbers: 0,
          isStealth: false,
          isShowAlertNoticeList: false,
        }
      },
      async mounted() {
        const currentDate = new Date();
        const currentYear = currentDate.getFullYear();
        const currentMonth = currentDate.getMonth() + 1; 
        this.currentDate = `${currentYear}-${currentMonth}`
        const data = this.notice_info
        if (data.hasOwnProperty("google_error_msg")) this.google_info = data.google_error_msg
        if (data.hasOwnProperty("info_list")) this.info_list = data.info_list
        if (data.hasOwnProperty("fault_information")) this.fault_information = data.fault_information
        if (data.hasOwnProperty("maintenance")) this.maintenance = data.maintenance
        this.notice_numbers = this.info_list.length + this.fault_information.length + this.maintenance.length

        if (data.hasOwnProperty("sales_amount")) this.SalesFee = data.sales_amount
        if (data.hasOwnProperty("usage_fee")) this.useFee = data.usage_fee
        if (data.hasOwnProperty("item_credit")) {
          this.imminentLoanExpiration.items = data.item_credit;
          if(data.item_credit.length > 0) this.imminentLoanExpirationCount += data.item_credit.length;
        }
        if (data.hasOwnProperty("webticket_credit")) {
          this.imminentLoanExpiration.webtickets = data.webticket_credit;
          if(data.webticket_credit.length > 0) this.imminentLoanExpirationCount += data.webticket_credit.length;
        }
        if (data.hasOwnProperty("gurumet_credit")) {
          this.imminentLoanExpiration.gurumets = data.gurumet_credit;
          if(data.gurumet_credit.length > 0) this.imminentLoanExpirationCount += data.gurumet_credit.length;
        }
        if (data.hasOwnProperty("beauty_credit")) {
          this.imminentLoanExpiration.beauties = data.beauty_credit;
          if(data.beauty_credit.length > 0) this.imminentLoanExpirationCount += data.beauty_credit.length;
        }
        if (data.hasOwnProperty("app_credit")) {
          this.imminentLoanExpiration.apps = data.app_credit;
          if(data.app_credit.length > 0) this.imminentLoanExpirationCount += data.app_credit.length;
        }
        if (data.hasOwnProperty("unpaid_lock_date")) {
          this.unpaidLock.lock_date = data.unpaid_lock_date;
          if(data.unpaid_lock_date) {
            this.unpaidLock.lock = true;
          } else {
            this.unpaidLock.lock = false;
          } 
        }
        if (data.hasOwnProperty("account_lock")) {
          this.accountLock = data.account_lock;
        }
        if (data.hasOwnProperty("withdraw")) {
          this.withdraw = data.withdraw;
        }
        if (data.hasOwnProperty("unpaid_list")) this.unpaidLock.list = data.unpaid_list;
        this.loading = false;
        const baseSetting = this.$store.state.basic.baseSetting;
        this.alert_notice_list = []
        this.info_list.forEach(item => {
          if (item.is_show_modal) this.alert_notice_list.push(item);
        });
        this.fault_information.forEach(item => {
          if (item.is_show_modal) this.alert_notice_list.push(item);
        });
        this.maintenance.forEach(item => {
          if (item.is_show_modal) this.alert_notice_list.push(item);
        });

        if (baseSetting.complete_flg1 !== 1 && document.referrer.includes('login.php')) {
          this.$nextTick(()=>{
            this.showModalAlertBasicSetting()
          })
        } else if (this.alert_notice_list.length > 0) {
          this.$nextTick(()=>{
            this.showModalAlertNoticeList()
          }) 
        }
      },
      computed: {
        getNoticeList() {
          return [{
              ...this.info_list[0],
              category: "運営より"
            },
            {
              ...this.fault_information[0],
              category: "障害情報"
            },
            {
              ...this.maintenance[0],
              category: "メンテナンス"
            },
          ]
        },
      },
      methods: {
        ...Vuex.mapActions(["setShopTokenAction", "setShopIdAction", "setErrorAction"]),
        getDateTime(date) {
          const datetime = moment(new Date(date)).format("YYYY/MM/DD HH:mm")
          return datetime
        },
        async onReadNotice(info_no){
          if(this.isStealth) return;
          const params = {
            action: "createNoticeReadInfo",
            shopToken: `074ed07ea95dd70ee3839797e3bfa64e`,
            cl_stm_noti_no: info_no,
          }
          const res = await api.axiosAction("dashboard_notice_read", params)
          if (res.hasOwnProperty("error_flag") && res.error_flag === 1) {
            this.showModalError(res)
            return
          }
        },
        showMove() {
          window.location.href = '/m02_item_list.php?google_type=error';
        },
        showModalInfo(info) {
          this.scrollControll(true)
          this.modalInfoData = info
          if(this.modalInfoData.level === 3 && this.modalInfoData.is_show_modal){
            this.onReadNotice(this.modalInfoData.no)
          }
          $("#modal-info").modal("show")
          $("#modal-info").on("hidden.bs.modal", e => {
            this.scrollControll(false)
            this.modalInfoData = {
              no: 0,
              notice_created_at: "",
              notice_updated_at: "",
              category: "",
              subject: "",
              body: "",
              level: 0,
              is_show_modal: false,
            }
          })
        },
        showCreditModal() {
          this.scrollControll(true)
          $("#modal-credit-info").modal("show");
          $("#modal-credit-info").on("hidden.bs.modal", e => {
            this.scrollControll(false)
          })
        },
        showModalAlertBasicSetting(){
          this.scrollControll(true)
          $("#modal-alert-basic-setting").modal("show");
          $("#modal-alert-basic-setting").on("hidden.bs.modal", e => {
            this.scrollControll(false)
            if(this.alert_notice_list.length > 0) {
              this.$nextTick(()=>{
                this.showModalAlertNoticeList()  
              })
            }
          })
        },
        showModalAlertNoticeList(){
          this.isShowAlertNoticeList = true;
          this.scrollControll(true)
          $("#modal-alert-notice-list").modal("show");
          $("#modal-alert-notice-list").on("hidden.bs.modal", e => {
            this.scrollControll(false)
          })
        }, 
        showModalAlertGoogleSetting(){
          this.scrollControll(true)
          $("#modal-alert-google-setting").modal("show");
          $("#modal-alert-google-setting").on("hidden.bs.modal", e => {
            this.scrollControll(false)
          })
        }, 
        showAccountLockModal() {
          $('.js-builder-error-message').hide();
          $('.js-account-error-message').hide();
          $('.js-app-error-message').hide();
          $('.js-payment-error-message').show();
          $("#modal-error-header-disable").modal();
        },
        scrollControll(newValue) {
          function calculateScrollbarWidth() {
            // スクロールバーの横幅を計算
            const scrollDiv = document.createElement('div');
            scrollDiv.className = 'scrollbar-measure';
            document.body.appendChild(scrollDiv);
            const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;
            document.body.removeChild(scrollDiv);
            return scrollbarWidth;
          }

          if (newValue) {
            // モーダルが表示されたときにスクロールを禁止
            const scrollbarWidth = calculateScrollbarWidth();
            document.documentElement.style.overflow = 'hidden';
            document.documentElement.style.paddingRight = `${scrollbarWidth}px`;
          } else {
            // モーダルが閉じられたときにスクロールを許可
            document.documentElement.style.overflowY = 'auto';
            document.documentElement.style.paddingRight = '0';
          }
        },
      },
    })
    //components
    const Spinner = window.VueSimpleSpinner
    const components = [
      loadVue(dashboardPath + 'Notice.vue'),
      loadVue(dashboardPath + 'NoticePromo.vue'),
      loadVue(dashboardPath + 'CardMessage.vue'),
      loadVue(dashboardPath + 'CardUpdateInfo.vue'),
      loadVue(dashboardPath + 'CardAlert.vue'),
      loadVue(dashboardPath + 'CardSummaryPageAccess.vue'),
      loadVue(dashboardPath + 'CardSummary.vue'),
      loadVue(dashboardPath + 'CardSummaryLong.vue'),
      loadVue(dashboardPath + 'CardSummaryOther.vue'),
      loadVue(dashboardPath + 'CardSummaryApp.vue'),
      loadVue(dashboardPath + 'CardSummaryShop.vue'),
      loadVue(dashboardPath + 'CardCustomerReview.vue'),
      loadVue(dashboardPath + 'CardSpecialEntry.vue'),
      loadVue(dashboardPath + 'OperationLog.vue'),
      loadVue(dashboardPath + 'ModalPromo.vue'),
      loadVue(modalPath + 'ModalSuccess.vue'),
      loadVue(modalPath + 'ModalError.vue'),
    ]
    const [
      Notice,
      NoticePromo,
      CardMessage,
      CardUpdateInfo,
      CardAlert,
      CardSummaryPageAccess,
      CardSummary,
      CardSummaryLong,
      CardSummaryOther,
      CardSummaryApp,
      CardSummaryShop,
      CardCustomerReview,
      CardSpecialEntry,
      OperationLog,
      ModalPromo,
     ] = await Promise.all(components);

    const app = new Vue({
      el: '#app',
      vuetify: new Vuetify(),
      store,
      components: {
        Spinner,
        Notice,
        NoticeCredit,
        NoticePromo,
        NoticeBuilder,
        CardMessage,
        CardUseFee,
        CardSalesFee,
        CardUpdateInfo,
        CardAlert,
        CardSummaryPageAccess,
        CardSummary,
        CardSummaryLong,
        CardSummaryOther,
        CardSummaryApp,
        CardSummaryShop,
        CardCustomerReview,
        CardSpecialEntry,
        CardNews,
        OperationLog,
        ModalError,
        ModalInfo,
        ModalPromo,
        ModalSuccess,
      },
      data() {
        return {
          loading: true,
          successInfo: {
            title: "",
            message: "",
          },
          areementInfo: {
            shop: 1,
            ds: 1,
            webticket: 1,
            event: 1,
            gurumet: 1,
            beauty: 1,
            farm: 1,
            app: 1,
          },
          yearMonthList: [],
          update_info: [],
          message: [],
          alertList: [{
              id: 1,
              category: "",
              title: "",
              datetime: "",
              url: "/",
            },
          ],
          summaryList: {
            page_access_summary: {},
            item_order_summary: {},
            ticket_summary: {},
            gurumet_summary: {},
            beauty_summary: {},
            farm_summary: {},
            user_summary: {},
            cashback_summary: {},
            mailmagazine_summary: {},
            cupon_summary: {},
            app_summary: {},
          },
          //新着レビュー
          customer_review: [],
          //特集エントリー
          ibent: [],
          options: {
            devNoticeListOption: {
              icon: '<img src="./images/tsukutsuku_sitelogo_white_mark.png" />',
              color: "#2875d4",
              title: "運営より",
              url: "/com_noti.php?c=1&searchNoti=&cmd=1",
            },
            mentenanceListOption: {
              icon: '<i class="fa-solid fa-wrench"></i>',
              color: "#848484",
              title: "メンテナンス",
              url: "/com_noti.php?c=2&searchNoti=&cmd=1",
            },
            systemErrorListOption: {
              icon: '<i class="fa-solid fa-bell"></i>',
              color: "#E89F96",
              title: "障害情報",
              url: "/com_noti.php?c=3&searchNoti=&cmd=1",
            },
          },
          summaryListApp: {},
          showGlobalTag: true,
          // 今後の参考のためにコメントとして残しておくこと
          // globalTagNotices: [
          //   {
          //     page_id: 68,
          //     show_page: true,
          //     banner:"banner-grobaltag-webticket.png",
          //     title: "ウェブチケット商品のグローバルタグの設定にご協力ください。（5月11日リリース機能）",
          //     body: `2023年5月11日にリリース実施において、ウェブチケットの商品管理に「グローバルタグ」の設定機能が追加されました。<br/>
          //       グローバルタグが設定されることにより、ウェブチケットサイトの商品検索ボックスにタグ検索のサジェスト（検索タグの候補）が表示されるようになります。<br/>
          //       現在（リリース直後）の状態において、登録済みの各商品には、グローバルタグが未設定であるため、ウェブチケットサイトのサジェストに表示される検索タグの候補がない（少ない）状態であります。<br/>
          //       加盟店様にはお手数をおかけしますが、ウェブチケットサイトのサジェスト（検索タグ）機能の向上（利便性アップ）のために、販売中ウェブチケットへのグローバルタグの設定登録につきまして、ご協力をお願いいたします。<br/>`
          //   },
          //   {
          //     page_id: 51,
          //     show_page: true,
          //     banner:"banner-grobaltag-tsuhan.png",
          //     title: "通販商品のグローバルタグの設定にご協力ください。（4月26日リリース機能）",
          //     body: `2023年4月26日にリリース実施において、通販の商品管理に「グローバルタグ」の設定機能が追加されました。<br/>
          //       グローバルタグが設定されることにより、通販サイトの商品検索ボックスにタグ検索のサジェスト（検索タグの候補）が表示されるようになります。<br/>
          //       現在（リリース直後）の状態において、登録済みの各商品には、グローバルタグが未設定であるため、通販サイトのサジェストに表示される検索タグの候補がない（少ない）状態であります。<br/>
          //       加盟店様にはお手数をおかけしますが、通販サイトのサジェスト（検索タグ）機能の向上（利便性アップ）のために、販売中商品へのグローバルタグの設定登録につきまして、ご協力をお願いいたします。<br/>`
          //   },            
          // ],
          // modalGlobalTagInfo: {
          //   page_id: 0,
          //   show_page: false,
          //   title: "",
          //   body: "",
          // },
          builderFlg: 0,
        }
      },
      async mounted() {
        this.setShopTokenAction("")
        this.setShopIdAction("0000187505")

        this.yearMonthList = Common.getRecentYM(5)

        const group1Params = {
          action: "dashboard_info",
          shopToken: this.$store.state.shopToken
        }
        const group2Params = {
          action: "get_dashboard_info",
          shopToken: this.$store.state.shopToken
        }
        const group3Params = {
          action: "dashboard_bottom_info",
          shopToken: this.$store.state.shopToken
        }
        const group3ParamsTmp = {
          action: "dashboard_info_summary",
          shopToken: this.$store.state.shopToken
        }
        const promises = [
          api.axiosAction("dashboard_info", group1Params),
          api.axiosAction("dashboard_info_summary", group2Params),
          api.axiosAction("dashboard_info", group3Params),
          api.axiosAction("dashboard_info_summary", group3ParamsTmp)
        ]
        // 最初に結果が返ってきたものから処理を行う
        for await (const result of promises) {
          if (result.hasOwnProperty("error_flag") && result.error_flag === 1) {
            this.showModalError(result.type)
            Common.hideSpinner();
            return
          }
          // actionがdashboard_infoの場合
          if (result.hasOwnProperty("update_info")) this.update_info = result.update_info
          if (result.hasOwnProperty("message")) this.message = result.message
          // actionがget_dashboard_infoの場合
          if (result.hasOwnProperty("data")) {
            //アプリコンテンツのデータセット
            this.setSummaryAppContents(result.data);
            //ページアクセスのデータセット
            this.setDashboardInfo(result.data);
            //通販・DS、ウェブチケ、グルメ、ビューティー、ファームのデータセット
            this.setSummaryShopContents(result.data);
          }
          // actionがdashboard_bottom_infoの場合
          if (result.hasOwnProperty("customer_review")) this.customer_review = result.customer_review
          if (result.hasOwnProperty("ibent")) this.ibent = result.ibent
          if (result.hasOwnProperty("user_cashback_summary")) this.summaryList.user_summary = this.getOtherSummary(result.user_cashback_summary, "user")
          if (result.hasOwnProperty("user_cashback_summary")) this.summaryList.cashback_summary = this.getOtherSummary(result.user_cashback_summary, "cash")
          if (result.hasOwnProperty("mailmagazine_cupon_summary")) this.summaryList.mailmagazine_summary = this.getOtherSummary(result.mailmagazine_cupon_summary, "mailmagazine")
          if (result.hasOwnProperty("mailmagazine_cupon_summary")) this.summaryList.cupon_summary = this.getOtherSummary(result.mailmagazine_cupon_summary, "cupon")
        }
        this.loading = false;
        Common.hideSpinner();
      },
      computed: {
        getSummaryList() {
          return [
            this.summaryList.productSales,
            this.summaryList.webTicket,
            this.summaryList.event,
            this.summaryList.gourmand,
            this.summaryList.beauty,
            this.summaryList.farm,
            this.summaryList.appContents,
          ]
        },
        getOtherSummaryList() {
          return [
            this.summaryList.user_summary,
            this.summaryList.cashback_summary,
            this.summaryList.mailmagazine_summary,
            this.summaryList.cupon_summary,
          ]
        },
        summaryListColor() {
          return {
            appColor: !!this.summaryList &&
              !!this.summaryList.app_summary &&
              !!this.summaryList.app_summary.options &&
              !!this.summaryList.app_summary.options.color
                ? `background-color: ${this.summaryList.app_summary.options.color}`
                : '',
            itemOrderColor: !!this.summaryList && 
              !!this.summaryList.item_order_summary &&
              !!this.summaryList.item_order_summary.options &&
              !!this.summaryList.item_order_summary.options.color
                ? `background-color: ${this.summaryList.item_order_summary.options.color}`
                : '',
            ticketColor: !!this.summaryList && 
              !!this.summaryList.ticket_summary &&
              !!this.summaryList.ticket_summary.options &&
              !!this.summaryList.ticket_summary.options.color
                ? `background-color: ${this.summaryList.ticket_summary.options.color}`
                : '',
            eventColor: !!this.summaryList && 
              !!this.summaryList.event_summary &&
              !!this.summaryList.event_summary.options &&
              !!this.summaryList.event_summary.options.color
                ? `background-color: ${this.summaryList.event_summary.options.color}`
                : '',
            gurumetColor: !!this.summaryList && 
              !!this.summaryList.gurumet_summary &&
              !!this.summaryList.gurumet_summary.options &&
              !!this.summaryList.gurumet_summary.options.color
                ? `background-color: ${this.summaryList.gurumet_summary.options.color}`
                : '',
            beautyColor: !!this.summaryList &&
              !!this.summaryList.beauty_summary &&
              !!this.summaryList.beauty_summary.options &&
              !!this.summaryList.beauty_summary.options.color
                ? `background-color: ${this.summaryList.beauty_summary.options.color}`
                : '',
            farmColor: !!this.summaryList &&
              !!this.summaryList.farm_summary &&
              !!this.summaryList.farm_summary.options &&
              !!this.summaryList.farm_summary.options.color
                ? `background-color: ${this.summaryList.farm_summary.options.color}`
                : '',
          }
        },
        summaryListIcon() {
          return {
            appIcon: !!this.summaryList &&
              !!this.summaryList.app_summary &&
              !!this.summaryList.app_summary.options &&
              !!this.summaryList.app_summary.options.icon
                ? this.summaryList.app_summary.options.icon
                : '',
            itemOrderIcon: !!this.summaryList && 
              !!this.summaryList.item_order_summary &&
              !!this.summaryList.item_order_summary.options &&
              !!this.summaryList.item_order_summary.options.icon
                ? this.summaryList.item_order_summary.options.icon
                : '',
            ticketIcon: !!this.summaryList && 
              !!this.summaryList.ticket_summary &&
              !!this.summaryList.ticket_summary.options &&
              !!this.summaryList.ticket_summary.options.icon
                ? this.summaryList.ticket_summary.options.icon
                : '',
            eventIcon: !!this.summaryList && 
              !!this.summaryList.event_summary &&
              !!this.summaryList.event_summary.options &&
              !!this.summaryList.event_summary.options.icon
                ? this.summaryList.event_summary.options.icon
                : '',
            gurumetIcon: !!this.summaryList && 
              !!this.summaryList.gurumet_summary &&
              !!this.summaryList.gurumet_summary.options &&
              !!this.summaryList.gurumet_summary.options.icon
                ? this.summaryList.gurumet_summary.options.icon
                : '',
            beautyIcon: !!this.summaryList &&
              !!this.summaryList.beauty_summary &&
              !!this.summaryList.beauty_summary.options &&
              !!this.summaryList.beauty_summary.options.icon
                ? this.summaryList.beauty_summary.options.icon
                : '',
            farmIcon: !!this.summaryList &&
              !!this.summaryList.farm_summary &&
              !!this.summaryList.farm_summary.options &&
              !!this.summaryList.farm_summary.options.icon
                ? this.summaryList.farm_summary.options.icon
                : '',
          }
        },
        // TODO: class="emg-notice"のリンクをクリックした際に遷移するページができた次第、emgNoticeItemを削除すること
        emgNoticeItem() {
          return {
            subject: "【重要】後払い決済弊社社名・住所表記誤りに関するお詫びと訂正",
            body: "平素はツクツク!!!ＣＭＳをご利用いただき、誠にありがとうございます。\r\n\r\n先日決済代行会社（マネーフォワード掛け払い/GMO掛け払い）よりお送りさせていただいた、初回の後払い決済請求書の弊社社名並びに住所表記に誤りがございました。\r\n深くお詫びいたしますとともに、以下の通り訂正させていただきます。\r\n\r\n【誤】\r\n旧社名：ツクツク株式会社\r\n旧住所：東京都港区芝公園2-11-1　住友不動産芝公園タワー1F\r\n\r\n【正】\r\n新社名：TSUKU TSUKU株式会社\r\n新住所：東京都港区浜松町2-4-1　世界貿易センタービルディング南館12F\r\n\r\n\r\nこの度は加盟店の皆様へ大変なご迷惑をおかけしましたことを心より深くお詫び申し上げます。\r\n\r\nTSUKU TSUKU株式会社\r\n管理部",
            regist:"2022-11-10 13:57:59.218546",
            update_date:"2022-11-10 13:57:59.218546",
            category: "運営より"
          }
        },
      },
      methods: {
        ...Vuex.mapActions(["setShopTokenAction", "setShopIdAction", "setErrorAction"]),
        getYearMonthList() {
          const list = []
          const thisMonth = moment().format("MM")
          list.push(thisMonth)
          for (let i = 0; i < 5; i++) {
            list.push(moment(thisMonth).subtract(i + 1, 'months').format("MM"))
          }
          return list
        },
        setIconColor(color) {
          return {
            background: color,
            filter: `drop-shadow(0px 0px 10px rgba(${color}, 0.5))`,
          }
        },
        getPageAccessList(summary) {
          return {
            title: summary.name,
            color: summary.options.color,
            summary: summary.totalPV,
          }
        },
        setDashboardInfo(data) {
          this.summaryList.page_access_summary = {
            all_total_pv_last2_month: data.all_total_pv_last2_month,
            all_total_pv_last_month: data.all_total_pv_last_month,
            all_total_pv_this_month: data.all_total_pv_this_month,
            home_total_pv_last2_month: data.home_total_pv_last2_month,
            home_total_pv_last_month: data.home_total_pv_last_month,
            home_total_pv_this_month: data.home_total_pv_this_month,
            product_sales_total_pv_last2_month: data.product_sales_total_pv_last2_month,
            product_sales_total_pv_last_month: data.product_sales_total_pv_last_month,
            product_sales_total_pv_this_month: data.product_sales_total_pv_this_month,
            ticket_total_pv_last2_month: data.ticket_total_pv_last2_month,
            ticket_total_pv_last_month: data.ticket_total_pv_last_month,
            ticket_total_pv_this_month: data.ticket_total_pv_this_month,
            event_total_pv_last2_month: data.event_item_pv_last2_month,
            event_total_pv_last_month: data.event_item_pv_last_month,
            event_total_pv_this_month: data.event_item_pv_this_month,
            gurumet_total_pv_last2_month: data.gurumet_total_pv_last2_month,
            gurumet_total_pv_last_month: data.gurumet_total_pv_last_month,
            gurumet_total_pv_this_month: data.gurumet_total_pv_this_month,
            beauty_total_pv_last2_month: data.beauty_total_pv_last2_month,
            beauty_total_pv_last_month: data.beauty_total_pv_last_month,
            beauty_total_pv_this_month: data.beauty_total_pv_this_month,
            farm_total_pv_last2_month: data.farm_total_pv_last2_month,
            farm_total_pv_last_month: data.farm_total_pv_last_month,
            farm_total_pv_this_month: data.farm_total_pv_this_month,
            coupon_total_pv_last2_month: data.coupon_total_pv_last2_month,
            coupon_total_pv_last_month: data.coupon_total_pv_last_month,
            coupon_total_pv_this_month: data.coupon_total_pv_this_month,
            next_sum_start_date: data.next_sum_start_date,
          };
        },
        setSummaryAppContents(summaryData) {
          this.summaryListApp = {
            no: summaryData.no,
            cl_stm_cd: summaryData.cl_stm_cd,
            app_order_cnt_all: summaryData.app_order_cnt_all || 0,
            app_order_cnt_this_month: summaryData.app_order_cnt_this_month || 0,
            app_order_cnt_last_month: summaryData.app_order_cnt_last_month || 0,
            app_order_cnt_last2_month: summaryData.app_order_cnt_last2_month || 0,
            app_order_cnt_past_info: summaryData.app_order_cnt_past_info || 0,
            app_order_amount_all: summaryData.app_order_amount_all || 0,
            app_order_amount_this_month: summaryData.app_order_amount_this_month || 0,
            app_order_amount_last_month: summaryData.app_order_amount_last_month || 0,
            app_order_amount_last2_month: summaryData.app_order_amount_last2_month || 0,
            app_order_amount_past_info: summaryData.app_order_amount_past_info,
            next_sum_start_date: summaryData.next_sum_start_date,
            app_graph_info: summaryData.app_graph_info,
          }
          this.summaryList.app_summary = {
            options: {
              color: this.$store.state.style.colors.gray,
              icon: 'fa-solid fa-mobile-screen-button',
            },
          }
        },
        setSummaryShopContents(summaryData) {
          // 通販・DS
          this.summaryList.item_order_summary = {
            name: "通販・DS",
            options: {
              col: "col-md-4",
              color: this.$store.state.style.colors.productSales,
              icon: 'fa-solid fa-bag-shopping',
              link: {
                edit: "/m02_item_list.php",
                manage: "/m02_item_order_01.php",
              }
            },
            total1: Number(summaryData.product_sales_shop_pv_all || 0) + Number(summaryData.product_sales_pv_past_info || 0) + Number(summaryData.product_sales_shop_pv_this_month || 0),
            total2: Number(summaryData.product_sales_item_pv_all || 0) + Number(summaryData.product_sales_item_pv_this_month || 0),
            total3: Number(summaryData.product_sales_order_cnt_all || 0) + Number(summaryData.product_sales_order_cnt_past_info || 0) + Number(summaryData.product_sales_order_cnt_this_month || 0),
            total4: Number(summaryData.product_sales_order_amount_all || 0) + Number(summaryData.product_sales_order_amount_past_info || 0) + Number(summaryData.product_sales_order_amount_this_month || 0),
            graph1_this_month: summaryData.product_sales_item_pv_this_month || 0,
            graph1_last_month: summaryData.product_sales_item_pv_last_month || 0,
            graph1_last2_month: summaryData.product_sales_item_pv_last2_month || 0,
            graph2_this_month: summaryData.product_sales_order_cnt_this_month || 0,
            graph2_last_month: summaryData.product_sales_order_cnt_last_month || 0,
            graph2_last2_month: summaryData.product_sales_order_cnt_last2_month || 0,
            graph3_this_month: summaryData.product_sales_order_amount_this_month || 0,
            graph3_last_month: summaryData.product_sales_order_amount_last_month || 0,
            graph3_last2_month: summaryData.product_sales_order_amount_last2_month || 0,
            graph_info: summaryData.product_sales_graph_info
          }

          // ウェブチケット
          this.summaryList.ticket_summary = {
            name: "ウェブチケット",
            options: {
              col: "col-md-4",
              color: this.$store.state.style.colors.webTicket,
              icon: 'fa-solid fa-ticket',
              link: {
                edit: "/m03_item_list.php",
                manage: "/m03_ticket_order.php",
              }
            },
            total1: Number(summaryData.ticket_shop_pv_all || 0) + Number(summaryData.ticket_pv_past_info || 0) + Number(summaryData.ticket_shop_pv_this_month || 0),
            total2: Number(summaryData.ticket_item_pv_all || 0) + Number(summaryData.ticket_item_pv_this_month || 0),
            total3: Number(summaryData.ticket_order_cnt_all || 0) + Number(summaryData.ticket_order_cnt_past_info || 0) + Number(summaryData.ticket_order_cnt_this_month || 0),
            total4: Number(summaryData.ticket_order_amount_all || 0) + Number(summaryData.ticket_order_amount_past_info || 0) + Number(summaryData.ticket_order_amount_this_month || 0),
            graph1_this_month: summaryData.ticket_item_pv_this_month || 0,
            graph1_last_month: summaryData.ticket_item_pv_last_month || 0,
            graph1_last2_month: summaryData.ticket_item_pv_last2_month || 0,
            graph2_this_month: summaryData.ticket_order_cnt_this_month || 0,
            graph2_last_month: summaryData.ticket_order_cnt_last_month || 0,
            graph2_last2_month: summaryData.ticket_order_cnt_last2_month || 0,
            graph3_this_month: summaryData.ticket_order_amount_this_month || 0,
            graph3_last_month: summaryData.ticket_order_amount_last_month || 0,
            graph3_last2_month: summaryData.ticket_order_amount_last2_month || 0,
            graph_info: summaryData.ticket_graph_info
          }
          // イベチケ
          this.summaryList.event_summary = {
            name: "イベチケ",
            options: {
              col: "col-md-4",
              color: this.$store.state.style.colors.event,
              icon: 'fa-solid fa-microphone',
              link: {
                edit: "https://event-cms.tsuku2.shop/cms/event/",
                manage: "https://event-cms.tsuku2.shop/cms/purchaser/",
              }
            },
            total1: Number(summaryData.event_shop_pv_all || 0) + Number(summaryData.event_shop_pv_this_month || 0),
            total2: Number(summaryData.event_item_pv_all || 0) + Number(summaryData.event_item_pv_this_month || 0),
            total3: Number(summaryData.event_order_cnt_all || 0) + Number(summaryData.event_order_cnt_this_month || 0),
            total4: Number(summaryData.event_order_amount_all || 0) + Number(summaryData.event_order_amount_this_month || 0),
            graph1_this_month: summaryData.event_item_pv_this_month || 0,
            graph1_last_month: summaryData.event_item_pv_last_month || 0,
            graph1_last2_month: summaryData.event_item_pv_last2_month || 0,
            graph2_this_month: summaryData.event_order_cnt_this_month || 0,
            graph2_last_month: summaryData.event_order_cnt_last_month || 0,
            graph2_last2_month: summaryData.event_order_cnt_last2_month || 0,
            graph3_this_month: summaryData.event_order_amount_this_month || 0,
            graph3_last_month: summaryData.event_order_amount_last_month || 0,
            graph3_last2_month: summaryData.event_order_amount_last2_month || 0,
            graph_info: summaryData.event_graph_info
          }

          // グルメ
          this.summaryList.gurumet_summary = {
            name: "グルメ",
            options: {
              col: "col-md-8",
              color: this.$store.state.style.colors.gourmand,
              icon: 'fa-solid fa-utensils',
              link: {
                edit: "m04_grmReserveCource.php",
                manage: "/m04_grmReserveList.php",
              }
            },
            total1: Number(summaryData.gurumet_shop_pv_all || 0) + Number(summaryData.gurumet_pv_past_info || 0) + Number(summaryData.gurumet_shop_pv_this_month || 0),
            total2: Number(summaryData.gurumet_reserve_pv_all || 0) + Number(summaryData.gurumet_reserve_pv_this_month || 0),
            total3: Number(summaryData.gurumet_reserve_cnt_all || 0) + Number(summaryData.gurumet_reserve_cnt_past_info || 0) + Number(summaryData.gurumet_reserve_cnt_this_month || 0),
            total4: Number(summaryData.gurumet_contract_cnt_all || 0) + Number(summaryData.gurumet_contract_cnt_past_info || 0) + Number(summaryData.gurumet_contract_cnt_this_month || 0),
            graph1_this_month: summaryData.gurumet_reserve_pv_this_month || 0,
            graph1_last_month: summaryData.gurumet_reserve_pv_last_month || 0,
            graph1_last2_month: summaryData.gurumet_reserve_pv_last2_month || 0,
            graph2_this_month: summaryData.gurumet_reserve_cnt_this_month || 0,
            graph2_last_month: summaryData.gurumet_reserve_cnt_last_month || 0,
            graph2_last2_month: summaryData.gurumet_reserve_cnt_last2_month || 0,
            graph3_this_month: summaryData.gurumet_contract_cnt_this_month || 0,
            graph3_last_month: summaryData.gurumet_contract_cnt_last_month || 0,
            graph3_last2_month: summaryData.gurumet_contract_cnt_last2_month || 0,
            graph_info: summaryData.gurumet_graph_info,
            reserve_people_all: Number(summaryData.gurumet_reserve_people_all) + Number(summaryData.gurumet_reserve_people_past_info) + Number(summaryData.gurumet_reserve_people_this_month),
            review_count: summaryData.gurumet_review_cnt
          }

          // ビューティー
          this.summaryList.beauty_summary = {
            name: "ビューティー",
            options: {
              col: "col-md-8",
              color: this.$store.state.style.colors.beauty,
              icon: 'bx bx-spa',
              link: {
                edit: "/m06_menuList.php",
                manage: "/m06_salonReserveList.php",
              }
            },
            total1: Number(summaryData.beauty_shop_pv_all || 0) + Number(summaryData.beauty_pv_past_info || 0) + Number(summaryData.beauty_shop_pv_this_month || 0),
            total2: Number(summaryData.beauty_reserve_pv_all || 0) + Number(summaryData.beauty_reserve_pv_this_month || 0),
            total3: Number(summaryData.beauty_reserve_cnt_all || 0) + Number(summaryData.beauty_reserve_cnt_past_info || 0) + Number(summaryData.beauty_reserve_cnt_this_month || 0),
            total4: Number(summaryData.beauty_contract_cnt_all || 0) + Number(summaryData.beauty_contract_cnt_past_info || 0) + Number(summaryData.beauty_contract_cnt_this_month || 0),
            graph1_this_month: summaryData.beauty_reserve_pv_this_month || 0,
            graph1_last_month: summaryData.beauty_reserve_pv_last_month || 0,
            graph1_last2_month: summaryData.beauty_reserve_pv_last2_month || 0,
            graph2_this_month: summaryData.beauty_reserve_cnt_this_month || 0,
            graph2_last_month: summaryData.beauty_reserve_cnt_last_month || 0,
            graph2_last2_month: summaryData.beauty_reserve_cnt_last2_month || 0,
            graph3_this_month: summaryData.beauty_contract_cnt_this_month || 0,
            graph3_last_month: summaryData.beauty_contract_cnt_last_month || 0,
            graph3_last2_month: summaryData.beauty_contract_cnt_last2_month || 0,
            graph_info: summaryData.beauty_graph_info,
            beauty_average: summaryData.beauty_average,
            review_count: summaryData.beauty_review_cnt
          }

          // ファーム
          this.summaryList.farm_summary = {
            name: "ファーム",
            options: {
              col: "col-md-4",
              color: this.$store.state.style.colors.farm,
              icon: 'fa-solid fa-tractor',
              link: {
                edit: "/m07_item_list.php",
                manage: "/m07_item_order_01.php",
              }
            },
            total1: Number(summaryData.farm_shop_pv_all || 0) + Number(summaryData.farm_pv_past_info || 0) + Number(summaryData.farm_shop_pv_this_month || 0),
            total2: Number(summaryData.farm_item_pv_all || 0) + Number(summaryData.farm_item_pv_this_month || 0),
            total3: Number(summaryData.farm_order_cnt_all || 0) + Number(summaryData.farm_order_cnt_past_info || 0) + Number(summaryData.farm_order_cnt_this_month || 0),
            total4: Number(summaryData.farm_order_amount_all || 0) + Number(summaryData.farm_order_amount_past_info || 0) + Number(summaryData.farm_order_amount_this_month || 0),
            graph1_this_month: summaryData.farm_item_pv_this_month || 0,
            graph1_last_month: summaryData.farm_item_pv_last_month || 0,
            graph1_last2_month: summaryData.farm_item_pv_last2_month || 0,
            graph2_this_month: summaryData.farm_order_cnt_this_month || 0,
            graph2_last_month: summaryData.farm_order_cnt_last_month || 0,
            graph2_last2_month: summaryData.farm_order_cnt_last2_month || 0,
            graph3_this_month: summaryData.farm_order_amount_this_month || 0,
            graph3_last_month: summaryData.farm_order_amount_last_month || 0,
            graph3_last2_month: summaryData.farm_order_amount_last2_month || 0,
            graph_info: summaryData.farm_graph_info
          }
        },
        getOtherSummary(data, type) {
          if (type === "user") {
            return {
              id: "summary-user",
              name: "ユーザー",
              url: "/m01_02_usr_tokei.php",
              options: {
                col: "col-md-3",
                color: "",
                icon: 'fa-solid fa-user-group',
              },
              summaries: [{
                name: "トータル集客ユーザ数",
                count: data.total_user,
                unit: "人",
                sub: {
                  name: "本日",
                  count: data.total_user_today,
                  unit: "人",
                },
              }, ],
              attractingContents: [{
                  category: data.rank_name_gold,
                  count: data.rank_cont_gold,
                },
                {
                  category: data.rank_name_silver,
                  count: data.rank_cont_silver,
                },
                {
                  category: data.rank_name_bronze,
                  count: data.rank_cont_bronze,
                },
              ],
            }
          } else if (type === "cash") {
            return {
              id: "summary-cashback",
              name: "キャッシュバック",
              url: "/m01_02_cashback.php",
              options: {
                col: "col-md-3",
                color: "",
                icon: 'fa-solid fa-cash-register',
              },
              summaries: [{
                  name: "キャッシュバック残高",
                  count: data.cashback,
                  unit: "円",
                  sub: {
                    name: "払出回数",
                    count: data.paid_count,
                    unit: "回",
                  },
                },
                {
                  name: "累計キャッシュバック",
                  count: data.cashback_total,
                  unit: "円",
                  sub: {
                    name: "発生件数",
                    count: data.cashback_cnt,
                    unit: "件",
                  },
                }
              ],
            }
          } else if (type === "mailmagazine") {
            return {
              id: "summary-mail",
              name: "メルマガ",
              url: "/m01_02_mailmag.php",
              options: {
                col: "col-md-3",
                color: "",
                icon: 'fa-solid fa-envelopes-bulk',
              },
              summaries: [{
                  name: "購読者数",
                  count: data.usrMailmagCnt,
                  unit: "人",
                  sub: {
                    name: "配信グループ数",
                    count: data.groupMailmagCnt,
                    unit: "",
                  },
                },
                {
                  name: "発行回数",
                  count: data.sendMailmagCnt0,
                  unit: "回",
                  sub: {
                    name: "配信数",
                    count: data.sendMailmagCnt1,
                    unit: "通",
                  },
                }
              ],
            }
          } else if (type === "cupon") {
            return {
              id: "summary-qoupon",
              name: "クーポン",
              url: "/m01_02_cpn.php",
              options: {
                col: "col-md-3",
                color: "",
                icon: 'fa-solid fa-gift',
              },
              summaries: [{
                  name: "作成クーポン数",
                  count: data.couponCnt0,
                  unit: "件",
                  sub: {
                    name: "掲載中",
                    count: data.couponCnt1,
                    unit: "件",
                  },
                },
                {
                  name: "特典クーポン発行数",
                  count: data.couponSPCnt0,
                  unit: "件",
                  sub: {
                    name: "利用回数",
                    count: data.couponSPCnt2,
                    unit: "件",
                  },
                }
              ],
            }
          }
        },
        showModalError(type) {
          this.$store.dispatch('setErrorTypeAction', type)
        },
        showModalPromo(){
          $("#modal-promo").modal("show");
        },
        // 参考のためコメントとして残しておくこと
        // showGlobalTagModal(index) {
        //   this.modalGlobalTagInfo = this.globalTagNotices[index];
        //   $('#modal-golbal-tag').modal("show");
        // },
        successAction(info){
          this.successInfo = info;
          $(this.$refs.modalSuccess.$el).modal("show");
          $('#modal-error').css('z-index', 1200);
        },
        errorAction(messages){
          this.setErrorAction(messages);
        }
      }
    });
  })()
  </script>
<script type="text/javascript"  src="/Jr97RV/-HEJG/aT4CY/oxcm/YaN5Jt0ScDzfLVQ3Xa/AB5YVy8/EGs/6XzYZZV4"></script><noscript><img src="https://cms2.tsuku2.shop/akam/13/pixel_1bb68b76?a=dD00ODhlODA0MmRiYWNiY2M5Nzc1NzdiYmEwZWVkYjRhMDEyYTRiNjk1JmpzPW9mZg==" style="visibility: hidden; position: absolute; left: -999px; top: -999px;" /></noscript></body>

</html>